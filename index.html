<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SheetPilot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: #33658A;
      color: #F5F5DC;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    select, input[type="text"], input[type="file"] {
      width: 100%;
      max-width: 380px;
      padding: 10px;
      margin-top: 6px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: none;
      font-size: 1em;
      box-sizing: border-box;
      display: block;
    }
    button {
      background-color: #00E5FF;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      margin-top: 10px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #00cce0;
    }
    p.note {
      color: #ccc;
      font-size: 0.85rem;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry</label>
  <select id="industry">
    <option value="">-- Select Industry --</option>
    <!-- Industry options will be populated by JavaScript -->
  </select>

  <label for="subcategory">Select Your Subcategory</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />
  <button id="loadButton" onclick="handleFile()">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Define industries and their subcategories
    const industries = {
      "Accounting": ["Bookkeeping", "Tax Preparation", "Auditing"],
      "Advertising": ["Digital Marketing", "Print Advertising", "Public Relations"],
      "Architecture": ["Residential Design", "Commercial Design", "Landscape Architecture"],
      "Auto Repair": ["Engine Repair", "Body Work", "Oil Change Services"],
      "Barbershop/Salon": ["Haircutting", "Styling", "Coloring"],
      "Childcare": ["Daycare", "Preschool", "After-School Programs"],
      "Cleaning Services": ["Residential Cleaning", "Commercial Cleaning", "Specialized Cleaning"],
      "Construction": ["Residential Construction", "Commercial Construction", "Remodeling"],
      "Consulting": ["Business Consulting", "IT Consulting", "Management Consulting"],
      "Courier Services": ["Local Delivery", "Express Shipping", "International Shipping"],
      "Creative Services": ["Graphic Design", "Video Production", "Photography"],
      "Customer Service": ["Call Centers", "Help Desk Support", "Customer Relationship Management"],
      "Education": ["K-12 Education", "Higher Education", "Online Learning"],
      "Electrical": ["Residential Electrical", "Commercial Electrical", "Industrial Electrical"],
      "Engineering": ["Civil Engineering", "Mechanical Engineering", "Electrical Engineering"],
      "Entertainment": ["Film Production", "Music Production", "Event Planning"],
      "Event Planning": ["Weddings", "Corporate Events", "Private Parties"],
      "Finance": ["Financial Planning", "Investment Banking", "Insurance"],
      "Fitness": ["Personal Training", "Group Classes", "Gym Management"],
      "Food & Beverage": ["Restaurants", "Catering", "Food Trucks"],
      "Government": ["Federal Agencies", "State Agencies", "Local Government"],
      "Healthcare": ["Hospitals", "Clinics", "Home Health Care"],
      "Home Improvement": ["Kitchen Remodeling", "Bathroom Remodeling", "Landscaping"],
      "Hospitality": ["Hotels", "Resorts", "Bed & Breakfasts"],
      "HR & Recruiting": ["Talent Acquisition", "Employee Training", "Payroll Services"],
      "Insurance": ["Life Insurance", "Health Insurance", "Property Insurance"],
      "Interior Design": ["Residential Design", "Commercial Design", "Space Planning"],
      "IT Services": ["Network Setup", "Software Development", "Technical Support"],
      "Landscaping": ["Lawn Care", "Garden Design", "Tree Services"],
      "Legal": ["Corporate Law", "Family Law", "Criminal Defense"],
      "Logistics": ["Supply Chain Management", "Freight Forwarding", "Inventory Management"],
      "Maintenance": ["Building Maintenance", "Equipment Maintenance", "Vehicle Maintenance"],
      "Manufacturing": ["Automotive Manufacturing", "Electronics Manufacturing", "Textile Manufacturing"],
      "Marketing": ["Market Research", "Brand Management", "Advertising Campaigns"],
      "Masonry": ["Bricklaying", "Stonework", "Concrete Work"],
      "Moving & Storage": ["Residential Moving", "Commercial Moving", "Storage Services"],
      "Non-Profit": ["Charitable Organizations", "Foundations", "Advocacy Groups"],
      "Painting": ["Residential Painting", "Commercial Painting", "Industrial Painting"],
      "Pet Grooming": ["Dog Grooming", "Cat Grooming", "Pet Spa Services"],
      "Photography": ["Portrait Photography", "Event Photography", "Commercial Photography"],
      "Plumbing": ["Residential Plumbing", "Commercial Plumbing", "Emergency Services"],
      "Printing": ["Digital Printing", "Offset Printing", "Large Format Printing"],
      "Product Design": ["Industrial Design", "User Experience Design", "Prototyping"],
      "Property Management": ["Residential Properties", "Commercial Properties", "Vacation Rentals"],
      "Publishing": ["Book Publishing", "Magazine Publishing", "Online Publishing"],
      "Real Estate": ["Residential Sales", "Commercial Sales", "Property Management"],
      "Retail": ["Clothing Stores", "Electronics Stores", "Grocery Stores"],
      "Roofing": ["Residential Roofing", "Commercial Roofing", "Roof Repairs"],
      "Security Services": ["Private Security", "Event Security", "Surveillance Systems"],
      "Technology": ["Software Development", "Hardware Manufacturing", "IT Services"],
      "Telecommunications": ["Internet Services", "Mobile Services", "Cable Services"],
      "Tourism": ["Travel Agencies", "Tour Operators", "Guided Tours"],
      "Transportation": ["Public Transportation", "Private Transportation", "Logistics"],
      "Trucking": ["Long-Haul Trucking", "Local Delivery", "Freight Services"],
      "Tutoring": ["Academic Tutoring", "Test Preparation", "Online Tutoring"],
      "Utilities": ["Electric Utilities", "Water Utilities", "Gas Utilities"],
      "Veterinary": ["Small Animal Practice", "Large Animal Practice", "Emergency Services"],
      "Warehouse": ["Storage Services", "Inventory Management", "Distribution"],
      "Waste Management": ["Recycling Services", "Hazardous Waste Disposal", "Landfill Management"],
      "Welding & Fabrication": ["Metal Fabrication", "Custom Welding", "Structural Welding"],
      "Wholesale": ["Food Wholesale", "Electronics Wholesale", "Clothing Wholesale"],
      "Writing & Editing": ["Content Writing", "Copy Editing", "Technical Writing"]
    };

    // Populate industry dropdown
    const industrySelect = document.getElementById('industry');
    for (let industry in industries) {
      let option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    }

    // Update subcategory dropdown based on selected industry
    industrySelect.addEventListener('change', () => {
      const subcategorySelect = document.getElementById('subcategory');
      subcategorySelect.innerHTML = '<option value="">-- Choose Subcategory --</option>';
      const selectedIndustry = industrySelect.value;
      if (industries[selectedIndustry]) {
        industries[selectedIndustry].forEach(subcat => {
          let option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    });

    function handleFile() {
      const fileInput = document.getElementById('fileUpload');
      if (!fileInput.files.length) {
        alert("Please select a file first.");
        return;
      }
      alert("File ready to be processed (functionality to be implemented).");
    }
  </script>

</body>
</html>

<!-- Phase 2: Column Mapping -->
<div id="phase2" style="margin-top: 40px;">
  <h2>Map Your Columns</h2>
  <p>Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to hide columns you donâ€™t want in the final table.</p>
  <div id="columnMappingContainer"></div>
  <button id="previewTableButton" style="margin-top: 15px; padding: 8px 16px; background: #00E5FF; color: #000; font-weight: bold; border: none; border-radius: 4px; cursor: pointer;">Preview Table</button>
  <div id="previewContainer" style="margin-top: 20px;"></div>
</div>

<script>
  // Phase 2 script
  let parsedData; // make sure this is set by Phase 1 script

  document.getElementById('addReplaceButton').addEventListener('click', () => {
    const fileInput = document.getElementById('fileInput');
    const file = fileInput.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        const data = e.target.result;
        const workbook = XLSX.read(data, { type: 'binary' });
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        parsedData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        buildColumnMapping(parsedData[0] || []);
      };
      reader.readAsBinaryString(file);
    }
  });

  function buildColumnMapping(headers) {
    const container = document.getElementById('columnMappingContainer');
    container.innerHTML = '';

    headers.forEach((header, index) => {
      const section = document.createElement('div');
      section.style.marginBottom = '10px';
      section.style.background = '#1E3A5F';
      section.style.padding = '10px';
      section.style.borderRadius = '5px';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = true;
      checkbox.id = `include_${index}`;

      const label = document.createElement('label');
      label.textContent = ' Include this column?';
      label.style.color = '#fff';
      label.style.marginLeft = '5px';

      const columnLabel = document.createElement('div');
      columnLabel.textContent = `Column: ${header}`;
      columnLabel.style.color = '#fff';
      columnLabel.style.marginTop = '5px';
      columnLabel.style.fontWeight = 'bold';

      const select = document.createElement('select');
      select.innerHTML = `<option value="${header}">${header}</option>`;
      select.style.width = '100%';
      select.style.marginTop = '5px';

      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'Or enter custom label';
      input.style.width = '100%';
      input.style.marginTop = '5px';

      section.appendChild(checkbox);
      section.appendChild(label);
      section.appendChild(columnLabel);
      section.appendChild(select);
      section.appendChild(input);
      container.appendChild(section);
    });
  }

  document.getElementById('previewTableButton').addEventListener('click', () => {
    const selectedIndices = [];
    const selectedHeaders = [];

    const mappingSections = document.getElementById('columnMappingContainer').children;
    Array.from(mappingSections).forEach((section, index) => {
      const includeCheckbox = section.querySelector('input[type="checkbox"]');
      if (includeCheckbox.checked) {
        selectedIndices.push(index);

        const input = section.querySelector('input[type="text"]');
        const customLabel = input.value.trim();
        const defaultHeader = section.querySelector('select').value;
        selectedHeaders.push(customLabel || defaultHeader);
      }
    });

    const table = document.createElement('table');
    table.style.width = '100%';
    table.style.marginTop = '10px';
    table.style.borderCollapse = 'collapse';
    table.style.backgroundColor = '#f0f0f0';
    table.style.color = '#000';

    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    selectedHeaders.forEach(header => {
      const th = document.createElement('th');
      th.textContent = header;
      th.style.padding = '8px';
      th.style.backgroundColor = '#00E5FF';
      th.style.color = '#000';
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    parsedData.slice(1).forEach(rowData => {
      const row = document.createElement('tr');
      selectedIndices.forEach(i => {
        const td = document.createElement('td');
        td.textContent = rowData[i] || '';
        td.style.padding = '6px';
        td.style.border = '1px solid #ccc';
        row.appendChild(td);
      });
      tbody.appendChild(row);
    });
    table.appendChild(tbody);

    const previewContainer = document.getElementById('previewContainer');
    previewContainer.innerHTML = '';
    previewContainer.appendChild(table);
  });
</script>
