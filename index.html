<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SheetPilot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: #33658A;
      color: #F5F5DC;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }
    select, input[type="text"], input[type="file"] {
      width: 100%;
      max-width: 380px;
      padding: 10px;
      margin-top: 6px;
      margin-bottom: 10px;
      border-radius: 6px;
      border: none;
      font-size: 1em;
      box-sizing: border-box;
      display: block;
    }
    button {
      background-color: #00E5FF;
      color: #000;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      margin-top: 10px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #00cce0;
    }
    p.note {
      color: #ccc;
      font-size: 0.85rem;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry</label>
  <select id="industry">
    <option value="">-- Select Industry --</option>
    <!-- Industry options will be populated by JavaScript -->
  </select>

  <label for="subcategory">Select Your Subcategory</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />
  <button id="loadButton" onclick="handleFile()">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    // Define industries and their subcategories
    const industries = {
      "Accounting": ["Bookkeeping", "Tax Preparation", "Auditing"],
      "Advertising": ["Digital Marketing", "Print Advertising", "Public Relations"],
      "Architecture": ["Residential Design", "Commercial Design", "Landscape Architecture"],
      "Auto Repair": ["Engine Repair", "Body Work", "Oil Change Services"],
      "Barbershop/Salon": ["Haircutting", "Styling", "Coloring"],
      "Childcare": ["Daycare", "Preschool", "After-School Programs"],
      "Cleaning Services": ["Residential Cleaning", "Commercial Cleaning", "Specialized Cleaning"],
      "Construction": ["Residential Construction", "Commercial Construction", "Remodeling"],
      "Consulting": ["Business Consulting", "IT Consulting", "Management Consulting"],
      "Courier Services": ["Local Delivery", "Express Shipping", "International Shipping"],
      "Creative Services": ["Graphic Design", "Video Production", "Photography"],
      "Customer Service": ["Call Centers", "Help Desk Support", "Customer Relationship Management"],
      "Education": ["K-12 Education", "Higher Education", "Online Learning"],
      "Electrical": ["Residential Electrical", "Commercial Electrical", "Industrial Electrical"],
      "Engineering": ["Civil Engineering", "Mechanical Engineering", "Electrical Engineering"],
      "Entertainment": ["Film Production", "Music Production", "Event Planning"],
      "Event Planning": ["Weddings", "Corporate Events", "Private Parties"],
      "Finance": ["Financial Planning", "Investment Banking", "Insurance"],
      "Fitness": ["Personal Training", "Group Classes", "Gym Management"],
      "Food & Beverage": ["Restaurants", "Catering", "Food Trucks"],
      "Government": ["Federal Agencies", "State Agencies", "Local Government"],
      "Healthcare": ["Hospitals", "Clinics", "Home Health Care"],
      "Home Improvement": ["Kitchen Remodeling", "Bathroom Remodeling", "Landscaping"],
      "Hospitality": ["Hotels", "Resorts", "Bed & Breakfasts"],
      "HR & Recruiting": ["Talent Acquisition", "Employee Training", "Payroll Services"],
      "Insurance": ["Life Insurance", "Health Insurance", "Property Insurance"],
      "Interior Design": ["Residential Design", "Commercial Design", "Space Planning"],
      "IT Services": ["Network Setup", "Software Development", "Technical Support"],
      "Landscaping": ["Lawn Care", "Garden Design", "Tree Services"],
      "Legal": ["Corporate Law", "Family Law", "Criminal Defense"],
      "Logistics": ["Supply Chain Management", "Freight Forwarding", "Inventory Management"],
      "Maintenance": ["Building Maintenance", "Equipment Maintenance", "Vehicle Maintenance"],
      "Manufacturing": ["Automotive Manufacturing", "Electronics Manufacturing", "Textile Manufacturing"],
      "Marketing": ["Market Research", "Brand Management", "Advertising Campaigns"],
      "Masonry": ["Bricklaying", "Stonework", "Concrete Work"],
      "Moving & Storage": ["Residential Moving", "Commercial Moving", "Storage Services"],
      "Non-Profit": ["Charitable Organizations", "Foundations", "Advocacy Groups"],
      "Painting": ["Residential Painting", "Commercial Painting", "Industrial Painting"],
      "Pet Grooming": ["Dog Grooming", "Cat Grooming", "Pet Spa Services"],
      "Photography": ["Portrait Photography", "Event Photography", "Commercial Photography"],
      "Plumbing": ["Residential Plumbing", "Commercial Plumbing", "Emergency Services"],
      "Printing": ["Digital Printing", "Offset Printing", "Large Format Printing"],
      "Product Design": ["Industrial Design", "User Experience Design", "Prototyping"],
      "Property Management": ["Residential Properties", "Commercial Properties", "Vacation Rentals"],
      "Publishing": ["Book Publishing", "Magazine Publishing", "Online Publishing"],
      "Real Estate": ["Residential Sales", "Commercial Sales", "Property Management"],
      "Retail": ["Clothing Stores", "Electronics Stores", "Grocery Stores"],
      "Roofing": ["Residential Roofing", "Commercial Roofing", "Roof Repairs"],
      "Security Services": ["Private Security", "Event Security", "Surveillance Systems"],
      "Technology": ["Software Development", "Hardware Manufacturing", "IT Services"],
      "Telecommunications": ["Internet Services", "Mobile Services", "Cable Services"],
      "Tourism": ["Travel Agencies", "Tour Operators", "Guided Tours"],
      "Transportation": ["Public Transportation", "Private Transportation", "Logistics"],
      "Trucking": ["Long-Haul Trucking", "Local Delivery", "Freight Services"],
      "Tutoring": ["Academic Tutoring", "Test Preparation", "Online Tutoring"],
      "Utilities": ["Electric Utilities", "Water Utilities", "Gas Utilities"],
      "Veterinary": ["Small Animal Practice", "Large Animal Practice", "Emergency Services"],
      "Warehouse": ["Storage Services", "Inventory Management", "Distribution"],
      "Waste Management": ["Recycling Services", "Hazardous Waste Disposal", "Landfill Management"],
      "Welding & Fabrication": ["Metal Fabrication", "Custom Welding", "Structural Welding"],
      "Wholesale": ["Food Wholesale", "Electronics Wholesale", "Clothing Wholesale"],
      "Writing & Editing": ["Content Writing", "Copy Editing", "Technical Writing"]
    };

    // Populate industry dropdown
    const industrySelect = document.getElementById('industry');
    for (let industry in industries) {
      let option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    }

    // Update subcategory dropdown based on selected industry
    industrySelect.addEventListener('change', () => {
      const subcategorySelect = document.getElementById('subcategory');
      subcategorySelect.innerHTML = '<option value="">-- Choose Subcategory --</option>';
      const selectedIndustry = industrySelect.value;
      if (industries[selectedIndustry]) {
        industries[selectedIndustry].forEach(subcat => {
          let option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    });

    function handleFile() {
      const fileInput = document.getElementById('fileUpload');
      if (!fileInput.files.length) {
        alert("Please select a file first.");
        return;
      }
      alert("File ready to be processed (functionality to be implemented).");
    }
  </script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SheetPilot - Phase 2</title>
<style>
  body {
    background-color: #33658A;
    color: #F5F5DC;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 20px;
  }
  h1 {
    font-size: 2rem;
    margin-bottom: 15px;
    color: #F5F5DC;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    color: #F5F5DC;
  }
  .column-map {
    margin-top: 15px;
    margin-bottom: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    padding: 15px;
  }
  select, input[type="text"] {
    width: 100%;
    max-width: 380px;
    padding: 10px;
    margin-top: 6px;
    border-radius: 6px;
    border: none;
    font-size: 1em;
    box-sizing: border-box;
  }
  button {
    background-color: #00E5FF;
    color: #000;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    margin-top: 10px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #00cce0;
  }
  table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    background-color: #1C1C2A;
    color: #F5F5DC;
  }
  th, td {
    padding: 8px;
    border: 1px solid #444;
  }
  th {
    background-color: #00E5FF;
    color: #000;
  }
  tr:nth-child(even) {
    background-color: #232338;
  }
</style>
</head>
<body>
  <h1>SheetPilot - Phase 2: Map Your Columns</h1>
  <p style="color: #ccc;">Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to hide columns you don’t want in the final table.</p>

  <div id="columnMappingContainer"></div>

  <button onclick="previewTable()">Preview Table</button>

  <div id="previewContainer"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
  // Load from the file uploaded in Phase 1
  document.addEventListener('DOMContentLoaded', () => {
    const fileInput = parent.document.querySelector('input[type=file]');
    if (fileInput && fileInput.files.length) {
      const file = fileInput.files[0];
      processFile(file);
    }
  });

  function processFile(file) {
    const reader = new FileReader();
    reader.onload = function(evt) {
      const data = new Uint8Array(evt.target.result);
      const workbook = XLSX.read(data, { type: 'array' });
      const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
      const json = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
      if (json.length) {
        createColumnMapping(json[0], json.slice(1));
      }
    };
    reader.readAsArrayBuffer(file);
  }

  function createColumnMapping(headers, rows) {
    const container = document.getElementById("columnMappingContainer");
    container.innerHTML = "";
    headers.forEach((header, index) => {
      const wrapper = document.createElement("div");
      wrapper.className = "column-map";

      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.checked = true;
      checkbox.style.marginRight = "8px";

      const label = document.createElement("label");
      label.textContent = `Column ${index + 1}: ${header}`;
      label.style.display = "inline";

      const select = document.createElement("select");
      const defaultOption = document.createElement("option");
      defaultOption.textContent = "-- Choose or type your own --";
      defaultOption.value = "";
      select.appendChild(defaultOption);

      // Basic suggestions
      ["Name", "Email", "Phone", "Date", "Amount", "Status", "Notes", "Service Type"].forEach(suggestion => {
        const opt = document.createElement("option");
        opt.value = suggestion;
        opt.textContent = suggestion;
        select.appendChild(opt);
      });

      const input = document.createElement("input");
      input.type = "text";
      input.placeholder = "Or enter custom label";

      wrapper.appendChild(checkbox);
      wrapper.appendChild(label);
      wrapper.appendChild(select);
      wrapper.appendChild(input);
      container.appendChild(wrapper);
    });

    container.dataset.rows = JSON.stringify(rows);
  }

  function previewTable() {
    const container = document.getElementById("columnMappingContainer");
    const rows = JSON.parse(container.dataset.rows || "[]");
    const wrappers = container.querySelectorAll(".column-map");
    const selectedHeaders = [];
    const columnsToShow = [];

    wrappers.forEach(wrapper => {
      const checkbox = wrapper.querySelector("input[type='checkbox']");
      if (checkbox.checked) {
        const select = wrapper.querySelector("select");
        const input = wrapper.querySelector("input[type='text']");
        const header = input.value.trim() || select.value || "Unnamed Column";
        selectedHeaders.push(header);
        columnsToShow.push(true);
      } else {
        columnsToShow.push(false);
      }
    });

    const table = document.createElement("table");
    const thead = document.createElement("thead");
    const trHead = document.createElement("tr");
    selectedHeaders.forEach(header => {
      const th = document.createElement("th");
      th.textContent = header;
      trHead.appendChild(th);
    });
    thead.appendChild(trHead);
    table.appendChild(thead);

    const tbody = document.createElement("tbody");
    rows.forEach(row => {
      const tr = document.createElement("tr");
      row.forEach((cell, index) => {
        if (columnsToShow[index]) {
          const td = document.createElement("td");
          td.textContent = cell || "";
          tr.appendChild(td);
        }
      });
      tbody.appendChild(tr);
    });
    table.appendChild(tbody);

    const previewContainer = document.getElementById("previewContainer");
    previewContainer.innerHTML = "";
    previewContainer.appendChild(table);
  }
</script>
</body>
</html>
