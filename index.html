<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SheetPilot â€“ Upload Your Sheet</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body {
      background-color: #2C4A5D;
      font-family: Arial, sans-serif;
      color: #FFF6DC;
      padding: 20px;
    }

    h1 {
      font-size: 1.8em;
      margin-bottom: 10px;
    }

    label {
      font-weight: bold;
      display: block;
      margin: 12px 0 5px;
    }

    select, input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: none;
      font-size: 1em;
    }

    input[type="file"] {
      margin-top: 5px;
    }

    #uploadSection {
      margin-top: 20px;
    }

    #loadButton {
      background-color: #00E0FF;
      color: black;
      font-weight: bold;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th {
      padding: 6px;
      background-color: #003366;
      color: white;
    }

    td {
      padding: 8px;
      border: 1px solid #ccc;
      background-color: #ffffff;
      color: #000;
    }

    .note {
      color: #B0B0B0;
      font-size: 0.9em;
      margin-top: 8px;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry:</label>
  <select id="industry" onchange="populateSubcategories()">
    <option value="">-- Select Industry --</option>
  </select>

  <label for="subcategory">Subcategory:</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or enter industry manually:</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or enter subcategory manually:</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <div id="uploadSection">
    <label>Upload Your File:</label>
    <input type="file" id="fileInput" />
    <br />
    <button id="loadButton">Add/Replace</button>
    <div class="note">Use this to upload additional data to the current table.</div>
    <div id="data-preview" style="margin-top: 20px;"></div>
  </div>

  <script>
    const industryMap = {
      "Tutoring": ["Math", "Science", "Test Prep", "Reading", "Writing"],
      "Pet Grooming": ["Mobile Grooming", "In-Home Grooming", "Salon Services"],
      "Real Estate": ["Residential", "Commercial", "REIT", "Land"],
      "Construction": ["General Contractor", "Framing", "Concrete", "Roofing"],
      "Barbershop/Salon": ["Men's Cuts", "Women's Styling", "Coloring", "Shaves"],
      "Nail Technician": ["Manicure", "Pedicure", "Acrylics", "Gel Polish"],
      "Tattoo & Piercings": ["Tattoo", "Piercing", "Tattoo Removal"],
      "HVAC": ["Residential", "Commercial", "Repair", "Installation"],
      "Plumbing": ["Drain Cleaning", "Water Heaters", "Remodels"],
      "Electrician": ["Residential", "Commercial", "Low Voltage"],
      "Landscaping": ["Design", "Maintenance", "Hardscaping"],
      "IT Services": ["Network Setup", "PC Repair", "Security"],
      "Digital Marketing": ["SEO", "Social Media", "Email"],
      "Photography": ["Weddings", "Portraits", "Events"],
      "Fitness": ["Personal Training", "Classes", "Nutrition"],
      "Cleaning Services": ["Residential", "Commercial", "Deep Clean"],
      "Automotive": ["Repair", "Detailing", "Tuning"],
      "Childcare": ["Babysitting", "Nanny", "Daycare"],
      "Food Services": ["Catering", "Meal Prep", "Delivery"],
      "Event Planning": ["Weddings", "Corporate", "Birthdays"],
      "Carpentry": ["Framing", "Trim Work", "Custom Furniture"],
      "Masonry": ["Brick", "Stone", "Repair"],
      "Welding & Fabrication": ["Pipe", "Automotive", "Custom Jobs"],
      "Security Services": ["Monitoring", "Installations"],
      "Nonprofit": ["Fundraising", "Community Outreach"],
      "Retail": ["Clothing", "Tech", "Home Goods"],
      "Education": ["Online Courses", "Tutoring", "Workshops"],
      "Tech Support": ["Remote Help", "Phone Support"],
      "Legal Services": ["Criminal", "Family", "Contract"],
      "Accounting": ["Tax Prep", "Bookkeeping"],
      "Therapy & Counseling": ["Individual", "Couples", "Family"],
      "Interior Design": ["Residential", "Commercial", "Staging"],
      "Painting": ["Interior", "Exterior", "Decorative"],
      "Roofing": ["Shingle", "Metal", "Inspection"],
      "Tree Services": ["Removal", "Trimming"],
      "Junk Removal": ["Residential", "Commercial"],
      "Handyman Services": ["Small Repairs", "Assembly"],
      "Courier Services": ["Food", "Packages", "Documents"],
      "Music Lessons": ["Piano", "Guitar", "Voice"],
      "Mechanic": ["General Repair", "Diagnostics"],
      "Pool Services": ["Cleaning", "Repair", "Installation"],
      "Window Cleaning": ["Commercial", "Residential"],
      "Copywriting": ["Sales Copy", "Blogs", "Web Content"],
      "Translation": ["Documents", "Live", "Technical"],
      "Social Work": ["Family", "Crisis"],
      "Veterinary Services": ["Small Animal", "Emergency"],
      "Crafts & Handmade": ["Etsy", "Markets"],
      "Baking": ["Cakes", "Pastries"],
      "Consulting": ["Business", "HR", "Sales"],
      "Legal Consulting": ["Litigation", "Compliance"],
      "Tax Services": ["Prep", "Filing", "Advisory"],
      "Insurance": ["Health", "Auto", "Life"],
      "Logistics": ["Freight", "Local Delivery"],
      "Farming": ["Produce", "Livestock"],
      "Real Estate Services": ["Staging", "Photography"],
      "Snow Removal": ["Residential", "Commercial"],
      "Virtual Assistant": ["Admin", "Inbox", "Research"],
      "Voice Over": ["Commercials", "Narration"],
      "Game Design": ["Mobile", "Indie", "PC"],
      "Woodworking": ["Custom Furniture", "Cabinetry"],
      "Moving Services": ["Local", "Long Distance"],
      "Window Tinting": ["Auto", "Home", "Office"],
      "Pest Control": ["Termites", "General"],
      "Pet Training": ["Obedience", "Behavioral"],
      "Tailoring": ["Alterations", "Custom Work"],
      "Hair Removal": ["Waxing", "Laser"],
      "Spa Services": ["Massage", "Facial", "Steam"]
    };

    function populateSubcategories() {
      const industrySelect = document.getElementById("industry");
      const subcategorySelect = document.getElementById("subcategory");
      const selectedIndustry = industrySelect.value;

      subcategorySelect.innerHTML = '<option value="">-- Choose Subcategory --</option>';

      if (industryMap[selectedIndustry]) {
        industryMap[selectedIndustry].forEach(sub => {
          const option = document.createElement("option");
          option.value = sub;
          option.textContent = sub;
          subcategorySelect.appendChild(option);
        });
      }
    }

    window.onload = () => {
      const industrySelect = document.getElementById("industry");
      for (let industry in industryMap) {
        const option = document.createElement("option");
        option.value = industry;
        option.textContent = industry;
        industrySelect.appendChild(option);
      }
    };

    document.getElementById("loadButton").addEventListener("click", function () {
      const fileInput = document.getElementById("fileInput");
      const file = fileInput.files[0];
      if (!file) {
        alert("Please upload a file first.");
        return;
      }

      const reader = new FileReader();

      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });

        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];

        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        showPreviewTable(jsonData);
      };

      reader.readAsArrayBuffer(file);
    });

    function showPreviewTable(data) {
      const previewDiv = document.getElementById("data-preview");
      previewDiv.innerHTML = "";

      const industry = document.getElementById("industry").value.trim() || document.getElementById("customIndustry").value.trim();
      const subcategory = document.getElementById("subcategory").value.trim() || document.getElementById("customSubcategory").value.trim();

      const defaultLabels = [
        "Ignore Column",
        "Client Name",
        "Service Date",
        "Amount",
        "Status",
        "Notes",
        "Phone",
        "Email",
        "Zip Code",
        "Approval",
        "Other"
      ];

      const table = document.createElement("table");

      data.forEach((row, rowIndex) => {
        const tr = document.createElement("tr");

        row.forEach((cell, colIndex) => {
          let cellElement;

          if (rowIndex === 0) {
            cellElement = document.createElement("th");
            const select = document.createElement("select");
            select.style.width = "100%";
            select.style.padding = "6px";
            select.style.border = "none";
            select.style.fontWeight = "bold";
            select.style.backgroundColor = "#003366";
            select.style.color = "white";
            select.dataset.colIndex = colIndex;

            defaultLabels.forEach(option => {
              const opt = document.createElement("option");
              opt.value = option;
              opt.textContent = option;
              select.appendChild(opt);
            });

            const guessed = defaultLabels.find(label =>
              label.toLowerCase().includes((cell || "").toLowerCase())
            );
            if (guessed) select.value = guessed;

            cellElement.appendChild(select);
          } else {
            cellElement = document.createElement("td");
            cellElement.textContent = cell ?? "";
            cellElement.style.padding = "8px";
            cellElement.style.border = "1px solid #ccc";
            cellElement.style.backgroundColor = "#ffffff";
            cellElement.style.color = "#000";
          }

          tr.appendChild(cellElement);
        });

        table.appendChild(tr);
      });

      previewDiv.appendChild(table);
    }
  </script>
</body>
</html>
