<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SheetPilot â€“ Phase 1</title>
  <style>
    body {
      background-color: #1C1C2A;
      color: #F5F5DC;
      font-family: 'Segoe UI', sans-serif;
      padding: 40px;
      margin: 0;
    }

    h2 {
      font-size: 2em;
      margin-bottom: 25px;
      color: #F5F5DC;
    }

    label {
      font-weight: bold;
      margin-top: 25px;
      display: block;
    }

    select, input[type="text"], input[type="file"] {
      width: 100%;
      max-width: 400px;
      padding: 12px;
      margin-top: 6px;
      margin-bottom: 15px;
      border-radius: 6px;
      border: none;
      font-size: 1em;
      box-sizing: border-box;
    }

    .button {
      background-color: #00E5FF;
      color: #000;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: bold;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      margin-top: 10px;
    }

    .button:hover {
      background-color: #00cce0;
    }

    .note {
      font-size: 0.9em;
      color: gray;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <h2>SheetPilot</h2>

  <label for="industry">Select Your Industry:</label>
  <select id="industry" onchange="updateSubcategories()">
    <option value="">-- Select Industry --</option>
  </select>

  <label for="subcategory">Subcategory:</label>
  <select id="subcategory">
    <option value="">-- Select Subcategory --</option>
  </select>

  <label for="manualIndustry">Or enter industry manually:</label>
  <input type="text" id="manualIndustry" placeholder="Custom Industry" />

  <label for="manualSubcategory">Or enter subcategory manually:</label>
  <input type="text" id="manualSubcategory" placeholder="Custom Subcategory" />

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />

  <button class="button" onclick="alert('This button will load your file and proceed to Phase 2')">Load File</button>
  <p class="note">Use this to upload additional data to the current table.</p>

  <script>
    const industrySubcategories = {
      "Healthcare": ["Hospitals", "Private Practice", "Medical Billing", "Medical Devices"],
      "Finance": ["Accounting", "Bookkeeping", "Credit Repair", "Wealth Management"],
      "Retail": ["Online Store", "Brick & Mortar", "Inventory Management", "POS Systems"],
      "Construction": ["Residential", "Commercial", "Permitting", "Project Management"],
      "Education": ["Tutoring", "eLearning", "School Districts", "Private Schools"],
      "Legal": ["Corporate Law", "Criminal Law", "Paralegal", "Compliance"],
      "Real Estate": ["Commercial", "Residential", "REIT", "Property Management"],
      "Logistics": ["Warehousing", "Fleet Management", "Freight", "Delivery Services"],
      "Marketing": ["Advertising", "Digital Marketing", "SEO", "Market Research"],
      "Technology": ["Software", "Hardware", "IT Services", "Cybersecurity"],
      "Food & Beverage": ["Restaurants", "Catering", "Wholesale", "Food Trucks"],
      "Automotive": ["Dealership", "Repair Shops", "Auto Parts", "Car Rentals"],
      "Travel & Hospitality": ["Hotels", "Travel Agencies", "Resorts", "Airlines"],
      "Media & Entertainment": ["Streaming", "Production", "Publishing", "Gaming"],
      "Manufacturing": ["Industrial", "Textile", "Electronics", "Machinery"],
      "Agriculture": ["Farming", "Livestock", "AgriTech", "Crop Distribution"],
      "Telecommunications": ["Cellular", "Internet Providers", "Cable", "Satellite"],
      "Energy": ["Oil & Gas", "Renewables", "Utilities", "Energy Consulting"],
      "Insurance": ["Life", "Auto", "Health", "Claims Processing"],
      "Nonprofit": ["Charities", "Foundations", "Volunteer Orgs", "Grant Writing"],
      "Human Resources": ["Recruiting", "Staffing", "Payroll", "Benefits"],
      "Event Planning": ["Weddings", "Corporate Events", "Festivals", "Catering"],
      "Fitness & Wellness": ["Gyms", "Personal Training", "Spas", "Yoga Studios"],
      "Beauty": ["Salons", "Cosmetics", "Skincare", "Aesthetic Clinics"],
      "Home Services": ["Plumbing", "Electricians", "HVAC", "Landscaping"],
      "Arts & Culture": ["Museums", "Galleries", "Performing Arts", "Workshops"],
      "Cleaning Services": ["Residential", "Commercial", "Specialty", "Eco-Friendly"],
      "Childcare": ["Daycare", "Nanny Services", "Afterschool", "Montessori"],
      "Pet Services": ["Veterinary", "Grooming", "Boarding", "Training"],
      "Security": ["Private Security", "Surveillance", "Cybersecurity", "Alarm Systems"],
      "Transportation": ["Taxi", "Bus", "Rail", "Logistics Brokers"],
      "E-commerce": ["Marketplaces", "Dropshipping", "Fulfillment", "Subscription"],
      "Consulting": ["Business", "Tech", "Management", "HR"],
      "Freelancing": ["Design", "Writing", "Development", "Virtual Assistants"],
      "Publishing": ["Books", "Magazines", "Academic", "Self-Publishing"],
      "Architecture": ["Residential", "Commercial", "Interior Design", "Urban Planning"],
      "Engineering": ["Civil", "Mechanical", "Electrical", "Environmental"],
      "Photography": ["Event", "Studio", "Commercial", "Editing Services"],
      "Tattoo & Piercing": ["Studios", "Supplies", "Aftercare", "Appointments"],
      "Political": ["Campaigns", "Advocacy", "Polling", "Consulting"],
      "Accounting": ["CPA", "Tax Filing", "Forensics", "Audit Services"],
      "Legal Tech": ["E-discovery", "Document Automation", "Case Management", "Compliance"],
      "Green Energy": ["Solar", "Wind", "Biofuel", "Consulting"],
      "Interior Design": ["Residential", "Commercial", "3D Modeling", "Furniture"],
      "Courier Services": ["Same-Day", "Scheduled", "International", "Tracking"],
      "Printing": ["Commercial", "Promotional", "On-Demand", "Publishing"],
      "Translation": ["Document", "Interpretation", "Software Localization", "Legal Translation"],
      "Auction & Resale": ["Online Auction", "Estate Sales", "Liquidation", "Collectibles"],
      "Adult Services": ["Counseling", "Wellness", "Education", "Subscription"],
      "Environmental": ["Recycling", "Sustainability Consulting", "Monitoring", "Waste Management"]
    };

    window.onload = function () {
      const industrySelect = document.getElementById("industry");
      Object.keys(industrySubcategories).forEach(industry => {
        const option = document.createElement("option");
        option.value = industry;
        option.textContent = industry;
        industrySelect.appendChild(option);
      });
    };

    function updateSubcategories() {
      const subcategorySelect = document.getElementById("subcategory");
      const selectedIndustry = document.getElementById("industry").value;
      subcategorySelect.innerHTML = "<option value=''>-- Select Subcategory --</option>";
      if (industrySubcategories[selectedIndustry]) {
        industrySubcategories[selectedIndustry].forEach(sub => {
          const option = document.createElement("option");
          option.value = sub;
          option.textContent = sub;
          subcategorySelect.appendChild(option);
        });
      }
    }
  </script>
</body>
</html>

<!-- Phase 2: Header Mapping + Preview -->
<div id="headerMappingSection" style="display:none; margin-top: 40px;">
  <h2 style="color: #F5F5DC;">Set Column Headers</h2>
  <div id="headerFields"></div>
  <button class="button" onclick="resetMapping()">Reset Mapping</button>
  <p style="color: gray; font-size: 0.9em;">Use this to reset the header mapping if you change industry or subcategory.</p>
  <button class="button" onclick="previewTable()">Preview Table</button>
</div>

<div id="tablePreview" style="margin-top: 40px; display:none;">
  <h2 style="color: #F5F5DC;">Preview Table</h2>
  <div id="previewContainer" style="overflow-x:auto;"></div>
</div>

<script>
  const suggestedHeaders = {
    "Retail": ["Product Name", "SKU", "Price", "Quantity", "Category"],
    "Finance": ["Client", "Account Type", "Balance", "Transaction Date", "Amount"],
    "Transportation": ["Driver", "Vehicle", "Route", "Date", "Distance"],
    // You can expand this list based on your industry selection
  };

  function showHeaderMapping(headers) {
    const container = document.getElementById("headerFields");
    container.innerHTML = "";

    const industry = document.getElementById("industry").value;
    const suggestions = suggestedHeaders[industry] || [];

    headers.forEach((header, i) => {
      const wrapper = document.createElement("div");
      wrapper.style.marginBottom = "15px";

      const label = document.createElement("label");
      label.textContent = `Column ${i + 1}`;
      label.style.color = "#F5F5DC";

      const select = document.createElement("select");
      select.style.width = "100%";
      select.style.padding = "10px";
      select.style.borderRadius = "6px";
      select.dataset.index = i;

      const blank = document.createElement("option");
      blank.value = "";
      blank.textContent = "-- Choose or type your own --";
      select.appendChild(blank);

      suggestions.forEach(s => {
        const option = document.createElement("option");
        option.value = s;
        option.textContent = s;
        select.appendChild(option);
      });

      const manualInput = document.createElement("input");
      manualInput.type = "text";
      manualInput.placeholder = "Or enter a custom label";
      manualInput.style.marginTop = "6px";
      manualInput.style.width = "100%";
      manualInput.dataset.index = i;

      const includeBox = document.createElement("input");
      includeBox.type = "checkbox";
      includeBox.checked = true;
      includeBox.id = `include-${i}`;

      const includeLabel = document.createElement("label");
      includeLabel.textContent = " Include this column";
      includeLabel.style.marginLeft = "6px";
      includeLabel.style.fontWeight = "bold";
      includeLabel.style.display = "block";
      includeLabel.style.color = "#F5F5DC";

      const helper = document.createElement("div");
      helper.textContent = "Uncheck this to exclude this column from the table and export.";
      helper.style.color = "gray";
      helper.style.fontSize = "0.85em";
      helper.style.marginTop = "3px";

      wrapper.appendChild(label);
      wrapper.appendChild(select);
      wrapper.appendChild(manualInput);
      wrapper.appendChild(includeBox);
      wrapper.appendChild(includeLabel);
      wrapper.appendChild(helper);

      container.appendChild(wrapper);
    });

    document.getElementById("headerMappingSection").style.display = "block";
  }

  function resetMapping() {
    document.getElementById("headerMappingSection").style.display = "none";
    document.getElementById("previewContainer").innerHTML = "";
    document.getElementById("tablePreview").style.display = "none";
  }

  function previewTable() {
    const selects = document.querySelectorAll("#headerFields select");
    const inputs = document.querySelectorAll("#headerFields input[type='text']");
    const checkboxes = document.querySelectorAll("#headerFields input[type='checkbox']");

    const headers = [];
    const includedIndexes = [];

    selects.forEach((select, i) => {
      const manualValue = inputs[i].value.trim();
      const useColumn = checkboxes[i].checked;

      if (!useColumn) return;

      includedIndexes.push(i);
      headers.push(manualValue || select.value || `Column ${i + 1}`);
    });

    const table = document.createElement("table");
    table.style.width = "100%";
    table.style.borderCollapse = "collapse";
    table.style.backgroundColor = "#1C1C2A";
    table.style.color = "#F5F5DC";
    table.style.fontSize = "0.95em";

    const thead = document.createElement("thead");
    const headerRow = document.createElement("tr");

    headers.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      th.style.backgroundColor = "#00E5FF";
      th.style.color = "#000";
      th.style.padding = "10px";
      headerRow.appendChild(th);
    });

    thead.appendChild(headerRow);
    table.appendChild(thead);

    const tbody = document.createElement("tbody");

    tableData.forEach((row, rIndex) => {
      const tr = document.createElement("tr");
      tr.style.backgroundColor = rIndex % 2 === 0 ? "#232338" : "#1C1C2A";

      includedIndexes.forEach(i => {
        const td = document.createElement("td");
        td.textContent = row[i] ?? "";
        td.style.padding = "8px";
        td.style.wordBreak = "break-word";
        td.style.borderTop = "1px solid #444";
        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });

    table.appendChild(tbody);

    const container = document.getElementById("previewContainer");
    container.innerHTML = "";
    container.appendChild(table);
    document.getElementById("tablePreview").style.display = "block";
  }
</script>
