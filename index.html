<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SheetPilot – Upload Your Sheet</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    body {
      background-color: #2C4A5D;
      font-family: Arial, sans-serif;
      color: #FFF6DC;
      padding: 20px;
    }

    h1 {
      font-size: 1.8em;
      margin-bottom: 10px;
    }

    label {
      font-weight: bold;
      display: block;
      margin: 12px 0 5px;
    }

    select, input[type="text"] {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      border: none;
      font-size: 1em;
    }

    input[type="file"] {
      margin-top: 5px;
    }

    #uploadSection {
      margin-top: 20px;
    }

    #loadButton {
      background-color: #00E0FF;
      color: black;
      font-weight: bold;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }

    .note {
      color: #B0B0B0;
      font-size: 0.9em;
      margin-top: 8px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th {
      background-color: #FFF6DC;
      color: #222;
      padding: 8px;
      border: 1px solid #bbb;
      text-align: left;
    }

    td {
      padding: 8px;
      border: 1px solid #ccc;
      color: #000;
    }

    tr:nth-child(even) td {
      background-color: #fdfdf9;
    }

    tr:nth-child(odd) td {
      background-color: #ffffff;
    }

    select, input[type="text"], input[type="file"], input[type="submit"] {
      box-sizing: border-box;
    }

    .instructions {
      margin-top: 16px;
      font-size: 0.95em;
      color: #FFF6DC;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry:</label>
  <select id="industry" onchange="populateSubcategories()">
    <option value="">-- Select Industry --</option>
  </select>

  <label for="subcategory">Subcategory:</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or enter industry manually:</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or enter subcategory manually:</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <div id="uploadSection">
    <label>Upload Your File:</label>
    <input type="file" id="fileInput" />
    <div class="note">Use this to upload additional data to the current table.</div>
    <div id="data-preview"></div>
  </div>

  <script>
  const industryMap = {
  "Construction": ["Translation", "Interpretation", "Localization", "Proofreading"],
  "Barbershop/Salon": ["Voiceover", "Dubbing", "Commercial"],
  "Copywriting": ["Routing", "Freight", "Fleet Management"],
  "Photography": ["HR Policy", "Hiring", "Payroll"],
  "Fitness": ["HR Policy", "Hiring", "Payroll", "Compliance"],
  "Plumbing": ["HR Policy", "Hiring", "Payroll", "Compliance"],
  "Electrician": ["Residential", "Commercial", "Emergency", "Maintenance"],
  "Pet Grooming": ["Residential", "Commercial", "Emergency", "Maintenance"],
  "Real Estate": ["Audit", "Tax Filing", "Bookkeeping", "Advisory"],
  "Education": ["Claims", "Underwriting", "Broker Services"],
  "Cleaning Services": ["Residential", "Commercial", "Emergency", "Maintenance"],
  "Legal Services": ["UI Audits", "User Testing", "Wireframes", "Prototypes"],
  "Therapy & Counseling": ["Claims", "Underwriting", "Broker Services", "Risk Management"],
  "Accounting": ["Prep", "Delivery", "Events", "Custom Orders"],
  "Marketing": ["Freight", "Owner-Operator", "Fleet", "Dispatching"],
  "Consulting": ["Repair", "Remodel", "Install", "Inspection"],
  "Software Development": ["Blogs", "Sales Copy", "Technical", "Web Content", "Email Campaigns"],
  "Tech Support": ["Freight", "Owner-Operator", "Fleet"],
  "Insurance": ["Audit", "Tax Filing", "Bookkeeping"],
  "Trucking": ["Routing", "Freight", "Fleet Management"],
  "Logistics": ["Tutoring", "Workshops", "Courses", "Exam Prep"],
  "Cybersecurity": ["HR Policy", "Hiring", "Payroll", "Compliance"],
  "Project Management": ["Training", "Classes", "Nutrition Plans", "Rehab"],
  "UX/UI Design": ["Training", "Classes", "Nutrition Plans", "Rehab"],
  "HR Services": ["Freight", "Owner-Operator", "Fleet", "Dispatching"],
  "Medical Billing": ["UI Audits", "User Testing", "Wireframes", "Prototypes"],
  "Speech Therapy": ["Routing", "Freight", "Fleet Management"],
  "Nutrition": ["Audit", "Tax Filing", "Bookkeeping", "Advisory"],
  "Veterinary Services": ["HR Policy", "Hiring", "Payroll", "Compliance"],
  "Childcare": ["Freight", "Owner-Operator", "Fleet", "Dispatching"],
  "Automotive Repair": ["Strategy", "Positioning", "Go-to-Market", "Sales Enablement"],
  "Landscaping": ["Weddings", "Portraits", "Events", "Studio Shoots"],
  "Painting": ["Translation", "Interpretation", "Localization"],
  "Roofing": ["HR Policy", "Hiring", "Payroll", "Compliance"],
  "Event Planning": ["Routing", "Freight", "Fleet Management"],
  "Tattoo Services": ["Routing", "Freight", "Fleet Management", "Last Mile"],
  "Pet Training": ["Training", "Classes", "Nutrition Plans"],
  "Baking": ["Training", "Classes", "Nutrition Plans", "Rehab"],
  "Catering": ["Tutoring", "Workshops", "Courses", "Exam Prep"],
  "Interior Design": ["Strategy", "Positioning", "Go-to-Market", "Sales Enablement"],
  "Retail": ["Residential", "Commercial", "Emergency", "Maintenance"],
  "E-commerce": ["Routing", "Freight", "Fleet Management", "Last Mile"],
  "Wholesale": ["Weddings", "Portraits", "Events", "Studio Shoots"],
  "Translation": ["Voiceover", "Dubbing", "Commercial", "Audiobook"],
  "Voice Over": ["Repair", "Remodel", "Install", "Inspection"],
  "Game Development": ["Prep", "Delivery", "Events", "Custom Orders"],
  "Music Lessons": ["Tutoring", "Workshops", "Courses"],
  "Personal Assistant": ["Translation", "Interpretation", "Localization"],
  "IT Consulting": ["Audit", "Tax Filing", "Bookkeeping", "Advisory"]
Object.assign(industryMap, {
  "Data Analysis": ["Claims", "Underwriting", "Broker Services"],
  "Business Strategy": ["Voiceover", "Dubbing", "Commercial"],
  "Product Management": ["Translation", "Interpretation", "Localization"],
  "UX Research": ["UI Audits", "User Testing", "Wireframes", "Prototypes"],
  "SEO Services": ["Voiceover", "Dubbing", "Commercial"],
  "Advertising": ["Voiceover", "Dubbing", "Commercial"],
  "Graphic Design": ["Residential", "Commercial", "Emergency", "Maintenance"],
  "3D Modeling": ["Training", "Classes", "Nutrition Plans"],
  "Animation": ["Blogs", "Sales Copy", "Technical"],
  "Video Editing": ["Claims", "Underwriting", "Broker Services"],
  "Podcast Editing": ["Retail", "Wholesale", "Dropshipping", "POS Support"],
  "Finance Advisory": ["Routing", "Freight", "Fleet Management", "Last Mile"],
  "Wealth Management": ["Claims", "Underwriting", "Broker Services"],
  "Tax Services": ["Routing", "Freight", "Fleet Management", "Last Mile"],
  "Nonprofit Outreach": ["Fundraising", "Volunteering", "Community Events"],
  "Fundraising": ["Email Campaigns", "Events", "Cold Outreach"],
  "Social Media Management": ["Strategy", "Posting", "Scheduling", "Analytics"],
  "Virtual Events": ["Zoom Setup", "Hosting", "Guest Coordination"],
  "Customer Service": ["Inbound", "Outbound", "Escalation", "Retention"],
  "Technical Writing": ["Manuals", "Whitepapers", "API Docs"],
  "Blog Writing": ["SEO Blogs", "Guest Posts", "How-To Articles"],
  "Ghostwriting": ["Books", "Thought Leadership", "Speeches"],
  "Resume Writing": ["Professional", "Executive", "LinkedIn"],
  "Real Estate Photography": ["Listings", "Drone", "Twilight Shots"],
  "Drone Videography": ["Real Estate", "Events", "Inspections"],
  "Voice Acting": ["Narration", "Commercials", "Animation"],
  "Conflict Mediation": ["Divorce", "Workplace", "Neighborhood"],
  "Life Coaching": ["Career", "Wellness", "Relationships"],
  "Sales Strategy": ["Pipeline", "Cold Outreach", "Objection Handling"],
  "Field Service Ops": ["Routing", "Tech Scheduling", "Inventory"],
  "Remote Work Consulting": ["Policy", "Security", "Communication"],
  "ERP Systems": ["Setup", "Training", "Integration"],
  "Supply Chain": ["Forecasting", "Warehouse", "Procurement"],
  "Procurement": ["Bids", "Vendor Selection", "Cost Analysis"],
  "Brand Strategy": ["Positioning", "Messaging", "Visual Identity"],
  "Web Hosting": ["Setup", "Migration", "Monitoring"],
  "CRM Setup": ["HubSpot", "Salesforce", "Zoho"],
  "Business Automation": ["Zapier", "Make.com", "Custom Scripts"],
  "Sales Funnel Design": ["Landing Pages", "Lead Magnets", "Email Automation"],
  "Health Coaching": ["Diet Plans", "Exercise Plans", "Accountability"],
  "Chiropractic Services": ["Adjustments", "Rehab", "Posture"],
  "Legal Tech": ["eDiscovery", "Contract AI", "Case Management"],
  "AI Integration": ["Chatbots", "Data Analysis", "Process Automation"],
  "Market Research": ["Surveys", "Focus Groups", "Competitor Analysis"],
  "Recruiting": ["Candidate Search", "Interviewing", "Onboarding"],
  "SaaS Product Setup": ["Trial Onboarding", "Integrations", "Analytics"]
});
    function populateSubcategories() {
      const industrySelect = document.getElementById("industry");
      const subcategorySelect = document.getElementById("subcategory");
      const selectedIndustry = industrySelect.value;

      subcategorySelect.innerHTML = '<option value="">-- Choose Subcategory --</option>';

      if (industryMap[selectedIndustry]) {
        industryMap[selectedIndustry].forEach(sub => {
          const option = document.createElement("option");
          option.value = sub;
          option.textContent = sub;
          subcategorySelect.appendChild(option);
        });
      }
    }

    window.onload = () => {
      const industrySelect = document.getElementById("industry");
      for (let industry in industryMap) {
        const option = document.createElement("option");
        option.value = industry;
        option.textContent = industry;
        industrySelect.appendChild(option);
      }
    };

    // === Phase 2: Auto-load file & parse ===
    document.getElementById("fileInput").addEventListener("change", function () {
      const file = this.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        showPreviewTable(jsonData);
      };
      reader.readAsArrayBuffer(file);
    });

    // === Phase 3: Preview + Custom Labels ===
    function showPreviewTable(data) {
      const previewDiv = document.getElementById("data-preview");
      previewDiv.innerHTML = "";

      const instructions = document.createElement("p");
      instructions.className = "instructions";
      instructions.innerHTML = "✏️ <strong>Use the dropdowns above each column to assign labels.</strong> Choose 'Ignore Column' to skip or enter a custom label.";
      previewDiv.appendChild(instructions);

      const defaultLabels = [
        "Ignore Column", "Client Name", "Service Date", "Amount", "Status",
        "Notes", "Phone", "Email", "Zip Code", "Approval", "Other"
      ];

      const table = document.createElement("table");

      data.forEach((row, rowIndex) => {
        const tr = document.createElement("tr");

        row.forEach((cell, colIndex) => {
          let cellElement;

          if (rowIndex === 0) {
            cellElement = document.createElement("th");

            const select = document.createElement("select");
            select.style.width = "100%";
            select.style.padding = "6px";
            select.style.marginBottom = "4px";

            defaultLabels.forEach(label => {
              const option = document.createElement("option");
              option.value = label;
              option.textContent = label;
              select.appendChild(option);
            });

            const guessed = defaultLabels.find(label =>
              label.toLowerCase().includes((cell || "").toLowerCase())
            );
            if (guessed) select.value = guessed;

            const input = document.createElement("input");
            input.type = "text";
            input.placeholder = "Custom Label";
            input.style.width = "100%";
            input.style.padding = "5px";
            input.style.border = "1px solid #ccc";
            input.style.borderRadius = "4px";

            input.addEventListener("input", () => {
              if (input.value.trim()) {
                select.value = "Other";
              }
            });

            cellElement.appendChild(select);
            cellElement.appendChild(input);
          } else {
            cellElement = document.createElement("td");
            cellElement.textContent = cell ?? "";
          }

          tr.appendChild(cellElement);
        });

        table.appendChild(tr);
      });

      previewDiv.appendChild(table);
    }
  </script>
</body>
</html>
