<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SheetPilot - Phase 1</title>
  <style>
    body {
      background-color: #33658A;
      color: #F5F5DC;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
    }
    select, input[type="text"] {
      background-color: #FFFFFF;
      border: 2px solid #F5F5DC;
      border-radius: 5px;
      padding: 8px;
      color: #000000;
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
      margin-top: 6px;
      margin-bottom: 10px;
    }
    button {
      background-color: #00E5FF;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #00cce0;
    }
  </style>
</head>
<body>

<h1>SheetPilot - Phase 1</h1>

<label for="industry">Select Your Industry:</label>
<select id="industry" onchange="updateSubcategories()">
  <option value="">-- Select Industry --</option>
</select>

<label for="subcategory">Select Your Subcategory:</label>
<select id="subcategory">
  <option value="">-- Choose Subcategory --</option>
</select>

<label for="customIndustry">Or Manually Enter Industry:</label>
<input type="text" id="customIndustry" placeholder="Custom Industry" />

<label for="customSubcategory">Or Manually Enter Subcategory:</label>
<input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

<script>
  const industryMap = {
    "Retail": ["Clothing Stores", "Convenience Stores", "Online Retail"],
    "Food & Beverage": ["Restaurants", "Food Trucks", "Catering Services"],
    "Beauty Services": ["Nail Salon", "Hair Salon", "Spa Services"],
    "Fitness & Wellness": ["Gyms", "Personal Trainers", "Yoga Studios"],
    "Construction": ["General Contracting", "Remodeling", "Roofing"]
  };

  function updateSubcategories() {
    const industry = document.getElementById("industry").value;
    const subcategory = document.getElementById("subcategory");
    subcategory.innerHTML = '<option value="">-- Choose Subcategory --</option>';
    if (industryMap[industry]) {
      industryMap[industry].forEach(option => {
        const el = document.createElement("option");
        el.value = option;
        el.textContent = option;
        subcategory.appendChild(el);
      });
    }
  }

  window.onload = () => {
    const industrySelect = document.getElementById("industry");
    Object.keys(industryMap).forEach(industry => {
      const option = document.createElement("option");
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });
  };
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SheetPilot - Phase 2</title>
  <style>
    body {
      background-color: #33658A;
      color: #F5F5DC;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: bold;
    }
    select, input[type="text"], input[type="file"] {
      background-color: #FFFFFF;
      border: 2px solid #F5F5DC;
      border-radius: 5px;
      padding: 8px;
      color: #000000;
      width: 100%;
      max-width: 400px;
      box-sizing: border-box;
      margin-top: 6px;
      margin-bottom: 10px;
    }
    button {
      background-color: #00E5FF;
      color: #000;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #00cce0;
    }
    .mapping-section {
      background: #1E3A5F;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .mapping-section label, .mapping-section div {
      color: #fff;
      margin-top: 5px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>SheetPilot - Phase 2</h1>

<label for="fileInput">Upload Your File:</label>
<input type="file" id="fileInput" />
<button id="addReplaceButton">Add/Replace</button>

<h2>Map Your Columns</h2>
<p>Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to exclude any columns you donâ€™t want in the final table.</p>

<div id="columnMappingContainer"></div>
<button id="previewTableButton">Preview Table</button>
<div id="previewContainer" style="margin-top: 20px;"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
  let parsedData;

  document.getElementById('fileInput').addEventListener('change', () => {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
      const data = e.target.result;
      const workbook = XLSX.read(data, { type: 'binary' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      parsedData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      buildColumnMapping(parsedData[0] || []);
    };
    reader.readAsBinaryString(file);
  });

  function buildColumnMapping(headers) {
    const container = document.getElementById('columnMappingContainer');
    container.innerHTML = '';
    headers.forEach(header => {
      const section = document.createElement('div');
      section.className = 'mapping-section';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = true;

      const dropdown = document.createElement('select');
      dropdown.innerHTML = `<option value="">-- Choose Header --</option>
                            <option>Client Name</option>
                            <option>Service Date</option>
                            <option>Amount</option>
                            <option>Status</option>
                            <option>Notes</option>
                            <option>Payment Status</option>`;

      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'Or enter custom header';

      section.appendChild(checkbox);
      section.appendChild(dropdown);
      section.appendChild(input);
      container.appendChild(section);
    });
  }

  document.getElementById('previewTableButton').addEventListener('click', () => {
    const selectedIndices = [];
    const selectedHeaders = [];
    const mappingSections = document.getElementById('columnMappingContainer').children;
    Array.from(mappingSections).forEach((section, index) => {
      const includeCheckbox = section.querySelector('input[type="checkbox"]');
      if (includeCheckbox.checked) {
        selectedIndices.push(index);
        const dropdownValue = section.querySelector('select').value.trim();
        const customLabel = section.querySelector('input[type="text"]').value.trim();
        selectedHeaders.push(customLabel || dropdownValue || parsedData[0][index]);
      }
    });

    const table = document.createElement('table');
    table.border = '1';
    const headerRow = table.insertRow();
    selectedHeaders.forEach(header => {
      const cell = headerRow.insertCell();
      cell.textContent = header;
    });

    parsedData.slice(1).forEach(row => {
      const newRow = table.insertRow();
      selectedIndices.forEach(i => {
        const cell = newRow.insertCell();
        cell.textContent = row[i] !== undefined ? row[i] : '';
      });
    });

    const previewContainer = document.getElementById('previewContainer');
    previewContainer.innerHTML = '';
    previewContainer.appendChild(table);
  });
</script>

</body>
</html>
