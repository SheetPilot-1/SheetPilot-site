<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SheetPilot</title>
  <style>
    body {
      background-color: #1e3a5f;
      color: #f5f5dc; /* Cream color */
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #f5f5dc;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      color: #f5f5dc;
      display: block;
      margin: 10px 0 5px;
    }
    select, input[type="text"] {
      background-color: white;
      border: 2px solid #f5f5dc;
      color: #333;
      padding: 8px;
      width: 100%;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .form-section {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border-radius: 8px;
    }
    .form-section button {
      background-color: #00bfff;
      color: #1e3a5f;
      font-weight: bold;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      display: block;
      width: 100%;
    }
    .form-section button:hover {
      background-color: #00a5d1;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>
  <div class="form-section">
    <label for="industry">Select Your Industry:</label>
    <select id="industry" onchange="populateSubcategories()">
      <option value="">-- Select Industry --</option>
    </select>

    <label for="subcategory">Select Your Subcategory:</label>
    <select id="subcategory">
      <option value="">-- Select Subcategory --</option>
    </select>

    <label for="customIndustry">Or Manually Enter Industry:</label>
    <input type="text" id="customIndustry" placeholder="Custom Industry" />

    <label for="customSubcategory">Or Manually Enter Subcategory:</label>
    <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />
  </div>

  <script>
    const industryData = {
      "Finance": ["Accountants", "Financial Planners", "Loan Officers", "Insurance Agents", "Tax Preparers"],
      "Legal": ["Lawyers", "Paralegals", "Court Reporters", "Legal Assistants", "Notary Services"],
      "Healthcare": ["Doctors", "Nurses", "Therapists", "Chiropractors", "Dentists"],
      "Technology": ["Software Developers", "IT Support", "Cybersecurity", "Web Designers", "Data Analysts"],
      "Marketing": ["Marketing Agencies", "SEO Experts", "Graphic Designers", "Social Media Managers", "Copywriters"],
      "Real Estate": ["Agents", "Brokers", "Property Managers", "Inspectors", "Stagers"],
      "Education": ["Tutors", "Private Schools", "Test Prep", "Music Teachers", "Daycare Providers"],
      "Hospitality": ["Hotels", "Event Planners", "Caterers", "Restaurants", "Bars"],
      "Retail": ["Convenience Stores", "Clothing Boutiques", "Grocery Stores", "Gift Shops", "Jewelry Stores"],
      "Construction": ["General Contractors", "Electricians", "Plumbers", "Roofers", "Painters"],
      "Automotive": ["Mechanics", "Detailers", "Body Shops", "Dealerships", "Car Washes"],
      "Transportation": ["Trucking", "Moving Services", "Taxi Services", "Limo Services", "Logistics"],
      "Cleaning Services": ["Residential", "Commercial", "Carpet Cleaning", "Window Washing", "Junk Removal"],
      "Personal Care": ["Barbers", "Salons", "Spas", "Massage Therapists", "Personal Trainers"],
      "Pet Services": ["Pet Grooming", "Pet Sitting", "Dog Walking", "Pet Training", "Pet Stores"],
      "Landscaping": ["Mowing", "Tree Services", "Gardening", "Snow Removal", "Hardscaping"],
      "Faith-Based": ["Churches", "Ministries", "Faith-Based Nonprofits", "Counseling Services", "Religious Bookstores"],
      "Photography": ["Wedding Photographers", "Portrait Studios", "Drone Photography", "Product Photography", "Event Photographers"],
      "Fitness & Wellness": ["Gyms", "Yoga Studios", "Nutritionists", "Health Coaches", "Pilates Instructors"],
      "Home Services": ["HVAC", "Appliance Repair", "Handyman", "Pest Control", "Security Systems"],
      "Media & Entertainment": ["Videographers", "DJs", "Theater Companies", "Music Bands", "Event Hosts"],
      "Childcare": ["Nannies", "Babysitters", "Preschools", "After-School Programs", "Summer Camps"],
      "Artisans & Crafts": ["Woodworkers", "Pottery", "Jewelry Makers", "Leatherworkers", "Glass Blowers"],
      "Manufacturing": ["Metal Fabrication", "Wood Manufacturing", "Textile Production", "Food Processing", "Tool Makers"],
      "Nonprofits": ["Human Services", "Food Banks", "Shelters", "Environmental Orgs", "Community Outreach"],
      "Consulting": ["Business Coaches", "Life Coaches", "HR Consultants", "Sales Consultants", "Brand Consultants"],
      "Event Services": ["Wedding Planners", "Party Rentals", "Caterers", "Florists", "Balloon Artists"],
      "Logistics & Supply": ["Warehousing", "Shipping", "Courier Services", "Inventory Management", "Import/Export"],
      "Insurance": ["Life Insurance", "Auto Insurance", "Health Insurance", "Homeowners Insurance", "Business Insurance"],
      "Agriculture": ["Crop Farmers", "Livestock Farmers", "Beekeepers", "Farmers Markets", "Agritourism"]
    };

    const industrySelect = document.getElementById('industry');
    const subcategorySelect = document.getElementById('subcategory');

    Object.keys(industryData).forEach(industry => {
      const option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });

    function populateSubcategories() {
      const selectedIndustry = industrySelect.value;
      subcategorySelect.innerHTML = '<option value="">-- Select Subcategory --</option>';

      if (industryData[selectedIndustry]) {
        industryData[selectedIndustry].forEach(subcat => {
          const option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SheetPilot - Phase 2</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <style>
    body {
      background-color: #1f5f89;
      color: #fff;
      font-family: sans-serif;
      padding: 20px;
    }
    h1 {
      color: #f5deb3; /* Bold cream color */
    }
    .header-section, .mapping-section {
      margin-bottom: 20px;
    }
    .dropdown-container {
      background-color: #1f5f89;
      border: 2px solid #f5deb3; /* Bold cream border */
      border-radius: 5px;
      padding: 10px;
      margin-bottom: 10px;
    }
    select, input[type="text"] {
      background-color: #fff;
      border: 1px solid #ccc;
      padding: 5px;
      width: 100%;
      margin-top: 5px;
      color: #000;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background-color: #fff;
      color: #000;
    }
    th, td {
      border: 1px solid #000;
      padding: 5px;
    }
    .btn {
      background-color: #00bfff;
      color: #000;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div class="header-section">
  <label for="fileInput">Upload Your File:</label>
  <input type="file" id="fileInput" accept=".xlsx" />
</div>

<div id="mappingSection" class="mapping-section"></div>

<button id="previewBtn" class="btn" style="display: none;">Preview Table</button>
<p>If you make changes, press this button again to see updates.</p>

<div id="tableContainer"></div>

<script>
  let workbookData = [];
  let headers = [];

  document.getElementById('fileInput').addEventListener('change', (e) => {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = (evt) => {
      const data = new Uint8Array(evt.target.result);
      const workbook = XLSX.read(data, { type: 'array' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      headers = json[0];
      workbookData = json.slice(1);
      createMappingDropdowns(headers);
    };
    reader.readAsArrayBuffer(file);
  });

  function createMappingDropdowns(headers) {
    const mappingSection = document.getElementById('mappingSection');
    mappingSection.innerHTML = '';

    headers.forEach((header, idx) => {
      const container = document.createElement('div');
      container.className = 'dropdown-container';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = true;

      const label = document.createElement('label');
      label.textContent = header;

      const select = document.createElement('select');
      const defaultOption = document.createElement('option');
      defaultOption.value = '';
      defaultOption.textContent = '-- Select Header --';
      select.appendChild(defaultOption);

      headers.forEach((h) => {
        const option = document.createElement('option');
        option.value = h;
        option.textContent = h;
        select.appendChild(option);
      });

      const customLabel = document.createElement('input');
      customLabel.type = 'text';
      customLabel.placeholder = 'Or enter custom label';

      container.appendChild(checkbox);
      container.appendChild(label);
      container.appendChild(select);
      container.appendChild(customLabel);
      mappingSection.appendChild(container);
    });

    document.getElementById('previewBtn').style.display = 'inline-block';
  }

  document.getElementById('previewBtn').addEventListener('click', () => {
    const containers = document.querySelectorAll('.dropdown-container');
    const activeHeaders = [];
    const headerMapping = {};

    containers.forEach((container, idx) => {
      const checkbox = container.querySelector('input[type="checkbox"]');
      if (!checkbox.checked) return;

      const select = container.querySelector('select');
      const customLabel = container.querySelector('input[type="text"]').value.trim();

      const finalLabel = customLabel || select.value || headers[idx];
      activeHeaders.push(finalLabel);
      headerMapping[finalLabel] = headers[idx];
    });

    const tableContainer = document.getElementById('tableContainer');
    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    activeHeaders.forEach((h) => {
      const th = document.createElement('th');
      th.textContent = h;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    workbookData.forEach((row) => {
      const tr = document.createElement('tr');
      activeHeaders.forEach((h) => {
        const td = document.createElement('td');
        const originalIndex = headers.indexOf(headerMapping[h]);
        td.textContent = row[originalIndex] || '';
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
    table.appendChild(tbody);

    tableContainer.innerHTML = '';
    tableContainer.appendChild(table);
  });
</script>

</body>
</html>
