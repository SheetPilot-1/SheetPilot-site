<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SheetPilot</title>
<style>
  body { background-color: #33658A; color: #F5F5DC; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
  h1 { font-size: 2rem; margin-bottom: 15px; color: #F5F5DC; }
  label { display: block; margin-top: 12px; font-weight: bold; color: #F5F5DC; }
  select, input[type="text"], input[type="file"] {
    width: 100%; max-width: 400px; padding: 8px; margin-top: 6px; margin-bottom: 10px;
    border-radius: 6px; border: 2px solid #F5F5DC; font-size: 1em; box-sizing: border-box;
    background-color: #ffffff; color: #000;
  }
  button { background-color: #00E5FF; color: #000; border: none; padding: 10px 20px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }
  button:hover { background-color: #00cce0; }
  .note { color: #ccc; font-size: 0.85rem; margin-top: 5px; }
  table { width: 100%; margin-top: 20px; border-collapse: collapse; background-color: #f0f0f0; color: #000; }
  th, td { padding: 8px; border: 1px solid #ccc; }
  th { background-color: #00E5FF; color: #000; }
  tr:nth-child(even) { background-color: #e0e0e0; }
  .section { margin-bottom: 20px; }
  .mapping-section {
    background: #33658A; padding: 10px; border-radius: 5px; margin-bottom: 10px;
  }
  .mapping-section div { margin-top: 5px; font-weight: bold; }
</style>
</head>
<body>

<h1>SheetPilot</h1>

<div class="section">
  <label for="industry">Select Your Industry:</label>
  <select id="industry" onchange="updateSubcategories()">
    <option value="">-- Select Industry --</option>
  </select>

  <label for="subcategory">Select Your Subcategory:</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry:</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory:</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileInput">Upload Your File:</label>
  <input type="file" id="fileInput" />
  <button id="addReplaceButton">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>
</div>

<div class="section">
  <h2>Map Your Columns</h2>
  <p>Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to hide columns you donâ€™t want in the final table.</p>
  <div id="columnMappingContainer"></div>
  <button id="previewTableButton">Preview Table</button>
  <span class="note">If you make changes, press this button again to see the updated table.</span>
  <div id="previewContainer" style="margin-top: 20px;"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
  const industryMap = {
    "Retail": ["Clothing Stores", "Convenience Stores", "Online Retail"],
    "Food & Beverage": ["Restaurants", "Food Trucks", "Catering"],
    "Barbershop & Beauty": ["Barbershop", "Tattoo Studio", "Nail Salon"],
    "Cleaning Services": ["Residential", "Commercial", "Carpet Cleaning"],
    "Fitness & Wellness": ["Gyms", "Yoga Studios", "Pilates Studios"],
    "Event Planning": ["Wedding Planning", "Corporate Events", "Party Planning"],
    "Construction & Renovation": ["Residential", "Commercial", "Remodeling"],
    "Automotive": ["Auto Repair", "Car Wash", "Detailing"],
    "Landscaping": ["Lawn Maintenance", "Tree Services", "Irrigation"],
    "Plumbing & HVAC": ["Plumbing", "HVAC Install", "Drain Cleaning"],
    "Electrical": ["Residential Electricians", "Commercial Electricians", "Lighting"],
    "Woodworking": ["Cabinet Making", "Wood Flooring", "Deck Building"],
    "Painting & Drywall": ["Interior Painting", "Exterior Painting", "Drywall Repair"],
    "Legal": ["Family Law", "Criminal Defense", "Corporate Law"],
    "Financial": ["Accounting", "Tax Preparation", "Bookkeeping"],
    "Marketing & Ads": ["Digital Marketing", "SEO Services", "Content Creation"],
    "Real Estate": ["Residential Sales", "Commercial Leasing", "Property Management"],
    "Transportation": ["Courier Services", "Moving Services", "Logistics"],
    "IT & Tech": ["Computer Repair", "Network Setup", "Tech Consulting"],
    "Consulting": ["Business Strategy", "HR Consulting", "Operations"],
    "Photography & Media": ["Event Photography", "Commercial Videography", "Drone Services"],
    "Education": ["Test Prep", "Tutoring", "Online Courses"],
    "Healthcare": ["Massage Therapy", "Chiropractic", "Physical Therapy"],
    "Non-Profit": ["Community Outreach", "Youth Programs", "Support Services"],
    "Faith-Based": ["Church Administration", "Faith Counseling", "Community Programs"]
  };

  const headerOptions = {
    "Retail": ["Product Name", "Price", "Quantity", "SKU"],
    "Food & Beverage": ["Item", "Price", "Quantity", "Date"],
    "Barbershop & Beauty": ["Service", "Price", "Client Name", "Date"],
    "Cleaning Services": ["Service", "Client Name", "Date", "Status"],
    "Fitness & Wellness": ["Class Name", "Trainer", "Client", "Session Time"],
    "Event Planning": ["Event Name", "Date", "Location", "Budget"],
    // ... Add relevant header options for each industry ...
  };

  function updateSubcategories() {
    const industry = document.getElementById("industry").value;
    const subcategory = document.getElementById("subcategory");
    subcategory.innerHTML = '<option value="">-- Choose Subcategory --</option>';
    if (industryMap[industry]) {
      industryMap[industry].forEach(option => {
        const el = document.createElement("option");
        el.value = option;
        el.textContent = option;
        subcategory.appendChild(el);
      });
    }
  }

  // Populate industries on load
  window.onload = () => {
    const industrySelect = document.getElementById("industry");
    Object.keys(industryMap).forEach(industry => {
      const option = document.createElement("option");
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });
  };

  let parsedData;

  document.getElementById('fileInput').addEventListener('change', () => {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
      const data = e.target.result;
      const workbook = XLSX.read(data, { type: 'binary' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      parsedData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      buildColumnMapping(parsedData[0] || []);
    };
    reader.readAsBinaryString(file);
  });

  function buildColumnMapping(headers) {
    const container = document.getElementById('columnMappingContainer');
    container.innerHTML = '';
    const selectedIndustry = document.getElementById("industry").value;
    const suggested = headerOptions[selectedIndustry] || [];

    headers.forEach(header => {
      const section = document.createElement('div');
      section.className = 'mapping-section';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = true;

      const columnLabel = document.createElement('div');
      columnLabel.textContent = header;

      const select = document.createElement('select');
      select.style.width = '100%';
      select.style.marginTop = '5px';
      select.style.backgroundColor = '#33658A';
      select.style.color = '#F5F5DC';
      select.style.border = '2px solid #F5F5DC';
      select.innerHTML = '<option value="">-- Select Header --</option>';
      suggested.forEach(option => {
        const el = document.createElement("option");
        el.value = option;
        el.textContent = option;
        select.appendChild(el);
      });

      const input = document.createElement('input');
      input.type = 'text';
      input.placeholder = 'Or enter custom label';
      input.style.width = '100%';
      input.style.marginTop = '5px';

      section.appendChild(checkbox);
      section.appendChild(columnLabel);
      section.appendChild(select);
      section.appendChild(input);
      container.appendChild(section);
    });
  }

  document.getElementById('previewTableButton').addEventListener('click', () => {
    const selectedIndices = [];
    const selectedHeaders = [];
    const mappingSections = document.getElementById('columnMappingContainer').children;
    Array.from(mappingSections).forEach((section, index) => {
      const includeCheckbox = section.querySelector('input[type="checkbox"]');
      if (includeCheckbox.checked) {
        selectedIndices.push(index);
        const select = section.querySelector('select').value;
        const input = section.querySelector('input[type="text"]').value.trim();
        const finalHeader = input || select || parsedData[0][index] || '';
        selectedHeaders.push(finalHeader);
      }
    });

    const table = document.createElement('table');
    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    selectedHeaders.forEach(header => {
      const th = document.createElement('th');
      th.textContent = header;
      headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    table.appendChild(thead);

    const tbody = document.createElement('tbody');
    parsedData.slice(1).forEach(rowData => {
      const row = document.createElement('tr');
      selectedIndices.forEach(i => {
        const td = document.createElement('td');
        td.textContent = rowData[i] || '';
        row.appendChild(td);
      });
      tbody.appendChild(row);
    });
    table.appendChild(tbody);

    const previewContainer = document.getElementById('previewContainer');
    previewContainer.innerHTML = '';
    previewContainer.appendChild(table);
  });
</script>
</body>
</html>
