<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SheetPilot</title>
  <style>
    body {
      background-color: #1e3a5f;
      color: #f5f5dc; /* Cream color */
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #f5f5dc;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      color: #f5f5dc;
      display: block;
      margin: 10px 0 5px;
    }
    select, input[type="text"] {
      background-color: white;
      border: 2px solid #f5f5dc;
      color: #333;
      padding: 8px;
      width: 100%;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .form-section {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border-radius: 8px;
    }
    .form-section button {
      background-color: #00bfff;
      color: #1e3a5f;
      font-weight: bold;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      display: block;
      width: 100%;
    }
    .form-section button:hover {
      background-color: #00a5d1;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>
  <div class="form-section">
    <label for="industry">Select Your Industry:</label>
    <select id="industry" onchange="populateSubcategories()">
      <option value="">-- Select Industry --</option>
    </select>

    <label for="subcategory">Select Your Subcategory:</label>
    <select id="subcategory">
      <option value="">-- Select Subcategory --</option>
    </select>

    <label for="customIndustry">Or Manually Enter Industry:</label>
    <input type="text" id="customIndustry" placeholder="Custom Industry" />

    <label for="customSubcategory">Or Manually Enter Subcategory:</label>
    <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />
  </div>

  <script>
    const industryData = {
      "Finance": ["Accountants", "Financial Planners", "Loan Officers", "Insurance Agents", "Tax Preparers"],
      "Legal": ["Lawyers", "Paralegals", "Court Reporters", "Legal Assistants", "Notary Services"],
      "Healthcare": ["Doctors", "Nurses", "Therapists", "Chiropractors", "Dentists"],
      "Technology": ["Software Developers", "IT Support", "Cybersecurity", "Web Designers", "Data Analysts"],
      "Marketing": ["Marketing Agencies", "SEO Experts", "Graphic Designers", "Social Media Managers", "Copywriters"],
      "Real Estate": ["Agents", "Brokers", "Property Managers", "Inspectors", "Stagers"],
      "Education": ["Tutors", "Private Schools", "Test Prep", "Music Teachers", "Daycare Providers"],
      "Hospitality": ["Hotels", "Event Planners", "Caterers", "Restaurants", "Bars"],
      "Retail": ["Convenience Stores", "Clothing Boutiques", "Grocery Stores", "Gift Shops", "Jewelry Stores"],
      "Construction": ["General Contractors", "Electricians", "Plumbers", "Roofers", "Painters"],
      "Automotive": ["Mechanics", "Detailers", "Body Shops", "Dealerships", "Car Washes"],
      "Transportation": ["Trucking", "Moving Services", "Taxi Services", "Limo Services", "Logistics"],
      "Cleaning Services": ["Residential", "Commercial", "Carpet Cleaning", "Window Washing", "Junk Removal"],
      "Personal Care": ["Barbers", "Salons", "Spas", "Massage Therapists", "Personal Trainers"],
      "Pet Services": ["Pet Grooming", "Pet Sitting", "Dog Walking", "Pet Training", "Pet Stores"],
      "Landscaping": ["Mowing", "Tree Services", "Gardening", "Snow Removal", "Hardscaping"],
      "Faith-Based": ["Churches", "Ministries", "Faith-Based Nonprofits", "Counseling Services", "Religious Bookstores"],
      "Photography": ["Wedding Photographers", "Portrait Studios", "Drone Photography", "Product Photography", "Event Photographers"],
      "Fitness & Wellness": ["Gyms", "Yoga Studios", "Nutritionists", "Health Coaches", "Pilates Instructors"],
      "Home Services": ["HVAC", "Appliance Repair", "Handyman", "Pest Control", "Security Systems"],
      "Media & Entertainment": ["Videographers", "DJs", "Theater Companies", "Music Bands", "Event Hosts"],
      "Childcare": ["Nannies", "Babysitters", "Preschools", "After-School Programs", "Summer Camps"],
      "Artisans & Crafts": ["Woodworkers", "Pottery", "Jewelry Makers", "Leatherworkers", "Glass Blowers"],
      "Manufacturing": ["Metal Fabrication", "Wood Manufacturing", "Textile Production", "Food Processing", "Tool Makers"],
      "Nonprofits": ["Human Services", "Food Banks", "Shelters", "Environmental Orgs", "Community Outreach"],
      "Consulting": ["Business Coaches", "Life Coaches", "HR Consultants", "Sales Consultants", "Brand Consultants"],
      "Event Services": ["Wedding Planners", "Party Rentals", "Caterers", "Florists", "Balloon Artists"],
      "Logistics & Supply": ["Warehousing", "Shipping", "Courier Services", "Inventory Management", "Import/Export"],
      "Insurance": ["Life Insurance", "Auto Insurance", "Health Insurance", "Homeowners Insurance", "Business Insurance"],
      "Agriculture": ["Crop Farmers", "Livestock Farmers", "Beekeepers", "Farmers Markets", "Agritourism"]
    };

    const industrySelect = document.getElementById('industry');
    const subcategorySelect = document.getElementById('subcategory');

    Object.keys(industryData).forEach(industry => {
      const option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });

    function populateSubcategories() {
      const selectedIndustry = industrySelect.value;
      subcategorySelect.innerHTML = '<option value="">-- Select Subcategory --</option>';

      if (industryData[selectedIndustry]) {
        industryData[selectedIndustry].forEach(subcat => {
          const option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SheetPilot – Phase 2</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      background-color: #2c6f91;
      color: #ffe7c7;
      font-family: sans-serif;
      padding: 20px;
    }
    h1 { margin-bottom: 20px; }
    select, input[type="text"], input[type="file"] {
      background-color: white;
      border: 2px solid #ffe7c7;
      border-radius: 4px;
      color: #333;
      padding: 6px;
      width: 100%;
      box-sizing: border-box;
      margin-top: 6px;
    }
    label { display: block; margin-top: 12px; }
    button {
      background-color: #00E5FF;
      border: none;
      border-radius: 4px;
      color: #000;
      cursor: pointer;
      font-weight: bold;
      margin-top: 20px;
      padding: 10px 16px;
    }
    button:hover { background-color: #00cce0; }
    table {
      border-collapse: collapse;
      margin-top: 20px;
      width: 100%;
    }
    th, td {
      border: 1px solid #ffe7c7;
      padding: 8px;
      text-align: left;
    }
    th { background-color: #00bfff; color: #000; }
    .mapping-section {
      margin-top: 10px;
    }
    .mapping-section select, .mapping-section input[type="text"] {
      margin-left: 10px;
      width: auto;
      display: inline-block;
    }
    .mapping-section input[type="checkbox"] {
      margin-left: 0;
    }
  </style>
</head>
<body>

  <h1>SheetPilot – Column Mapping</h1>

  <label for="industrySelect">Choose Industry:</label>
  <select id="industrySelect"></select>

  <label for="subcategorySelect">Choose Subcategory:</label>
  <select id="subcategorySelect"></select>

  <label for="fileInput">Upload Your File:</label>
  <input type="file" id="fileInput" />

  <div id="mappingContainer"></div>

  <button onclick="previewTable()">Preview Table</button>

  <table id="previewTable"></table>

  <script>
    const industryMap = {
      "Healthcare": {
        "Doctor": ["Patient Name","Visit Date","Procedure","Amount Billed","Insurance Status"],
        "Nurse": ["Patient Name","Shift Date","Ward","Hours Worked","Supervisor"],
        "Therapist": ["Client Name","Session Date","Treatment","Session Fee","Notes"],
        "Dentist": ["Patient Name","Appointment Date","Procedure","Cost","Payment Status"],
        "Pharmacist": ["Customer Name","Prescription Date","Medication","Qty","Insurance"]
      },
      "Finance": {
        "Accountant": ["Client Name","Invoice Date","Service","Amount","Paid Status"],
        "Tax Consultant": ["Client Name","Filing Date","Service Type","Fee","Status"],
        "Auditor": ["Client Name","Audit Date","Findings","Fee","Follow-up"],
        "Financial Advisor": ["Client Name","Consult Date","Plan Type","Advisory Fee","Status"],
        "Bookkeeper": ["Client Name","Entry Date","Service","Charge","Paid Status"]
      },
      "Construction": {
        "General Contractor": ["Client Name","Project Date","Project Type","Project Cost","Status"],
        "Electrician": ["Customer Name","Service Date","Work Type","Charge","Payment Status"],
        "Plumber": ["Customer Name","Job Date","Job Type","Charge","Notes"],
        "Roofer": ["Client Name","Estimate Date","Roof Type","Amount","Status"],
        "Carpenter": ["Customer Name","Job Date","Work Type","Charge","Payment"]
      },
      "Education": {
        "Tutor": ["Student Name","Session Date","Subject","Fee","Attendance"],
        "Test Prep": ["Student Name","Test Date","Course","Money Paid","Status"],
        "Online Instructor": ["Learner Name","Session Date","Course Module","Fee","Feedback"],
        "Education Consultant": ["School Name","Consult Date","Service Type","Fee","Status"],
        "Educational Content": ["Project Name","Delivery Date","Topic","Rate","Reviewed"]
      },
      "Real Estate": {
        "Agent": ["Client Name","Property Type","Listing Date","Commission","Status"],
        "Property Manager": ["Tenant Name","Lease Date","Property","Rent","Payment Status"],
        "Appraiser": ["Client Name","Appraisal Date","Property","Appraised Value","Notes"],
        "Leasing Agent": ["Tenant Name","Start Date","Unit","Rent","Status"],
        "Real Estate Investor": ["Property","Purchase Date","Investment Type","Amount","Status"]
      },
      "Retail": {
        "Clothing Store": ["Customer","Sale Date","Item","Amount","Payment Method"],
        "Convenience Store": ["Customer","Purchase Date","Product","Qty","Total"],
        "Online Retail": ["Customer","Order Date","Item","Price","Order Status"],
        "Specialty Shop": ["Customer","Purchase Date","Product","Price","Payment Status"],
        "Grocery": ["Customer","Purchase Date","Items","Total","Payment"]
      },
      "Food & Beverage": {
        "Restaurant": ["Customer","Order Date","Menu Item","Bill Amount","Payment Status"],
        "Food Truck": ["Customer","Sale Date","Menu Item","Amount","Transaction Status"],
        "Catering": ["Client","Event Date","Service Type","Fee","Status"],
        "Bakery": ["Customer","Purchase Date","Product","Price","Payment Status"],
        "Cafe": ["Customer","Order Date","Items","Total","Payment Status"]
      },
      "Automotive": {
        "Auto Repair": ["Customer","Service Date","Repair Type","Cost","Status"],
        "Car Wash": ["Customer","Wash Date","Package","Fee","Payment Status"],
        "Auto Detailing": ["Client","Service Date","Detail Level","Charge","Status"],
        "Tire Service": ["Client","Service Date","Car Model","Charge","Payment Status"],
        "Oil Change": ["Customer","Service Date","Vehicle","Fee","Payment Status"]
      },
      "IT Services": {
        "Computer Repair": ["Client","Service Date","Issue","Charge","Status"],
        "Network Setup": ["Client","Install Date","Network Type","Fee","Status"],
        "Software Install": ["Client","Install Date","Software","Fee","Paid"],
        "Tech Consulting": ["Client","Consult Date","Service","Fee","Status"],
        "Cybersecurity": ["Client","Assessment Date","Service","Charge","Status"]
      },
      "Legal": {
        "Family Law": ["Client","Case Type","Start Date","Fee","Case Status"],
        "Criminal Defense": ["Client","Arrest Date","Service","Fee","Status"],
        "Corporate Law": ["Client","Engagement Date","Service","Fee","Status"],
        "Estate Planning": ["Client","Plan Date","Plan Type","Fee","Status"],
        "Legal Aid": ["Client","Service Date","Type","Fee","Status"]
      },
      "Marketing": {
        "Digital Marketing": ["Client","Launch Date","Channel","Budget","Status"],
        "SEO": ["Client","Project Start","Keyword","Monthly Fee","Status"],
        "Social Media": ["Client","Campaign Date","Platform","Cost","Status"],
        "Content Creation": ["Client","Deliverable Date","Content Type","Fee","Status"],
        "PR Services": ["Client","Campaign Date","Service","Fee","Status"]
      },
      "Cleaning Services": {
        "Residential Cleaning": ["Client","Service Date","Home Size","Charge","Status"],
        "Commercial Cleaning": ["Client","Date","Building","Charge","Status"],
        "Carpet Cleaning": ["Client","Service Date","Area","Charge","Status"],
        "Window Cleaning": ["Client","Service Date","Building","Charge","Status"],
        "Deep Cleaning": ["Client","Service Date","Location","Charge","Status"]
      },
      "Beauty Services": {
        "Salon": ["Client","Service Date","Service","Charge","Payment Status"],
        "Nail Salon": ["Client","Appointment Date","Service","Charge","Payment Status"],
        "Spa": ["Client","Visit Date","Treatment","Charge","Status"],
        "Makeup Artist": ["Client","Date","Event","Fee","Status"],
        "Hair Extensions": ["Client","Application Date","Hair Type","Fee","Status"]
      },
      "Fitness": {
        "Gym": ["Member","Check-in Date","Trainer","Session Fee","Status"],
        "Personal Training": ["Client","Session Date","Trainer","Fee","Status"],
        "Yoga Studio": ["Student","Date","Class Type","Fee","Status"],
        "Pilates": ["Client","Session Date","Instructor","Fee","Status"],
        "Martial Arts": ["Student","Class Date","Instructor","Fee","Status"]
      },
      "Event Planning": {
        "Wedding": ["Client","Event Date","Service","Fee","Status"],
        "Corporate": ["Client","Event Date","Service","Fee","Status"],
        "Party Planning": ["Client","Event Date","Service","Fee","Status"],
        "Event Coordination": ["Client","Date","Service","Fee","Status"],
        "Conference": ["Client","Conference Date","Service","Fee","Status"]
      },
      "Transportation": {
        "Courier": ["Client","Pickup Date","Destination","Fee","Status"],
        "Freight": ["Client","Ship Date","Load Type","Fee","Status"],
        "Taxi Service": ["Customer","Ride Date","Distance","Fare","Payment Status"],
        "Ride Share": ["Customer","Trip Date","Route","Fare","Status"],
        "Moving": ["Client","Move Date","Truck Size","Charge","Status"]
      },
      "Manufacturing": {
        "Electronics": ["Client","Order Date","Product","Quantity","Charge"],
        "Furniture": ["Client","Order Date","Product","Quantity","Charge"],
        "Textiles": ["Client","Order Date","Fabric","Quantity","Charge"],
        "Automotive Parts": ["Client","Order Date","Part","Quantity","Charge"],
        "Machinery": ["Client","Order Date","Machine","Quantity","Charge"]
      },
      "Consulting": {
        "Business Strategy": ["Client","Meeting Date","Service","Fee","Status"],
        "HR Consulting": ["Client","Date","Service","Fee","Status"],
        "Ops Management": ["Client","Date","Service","Fee","Status"],
        "Process Improvement": ["Client","Date","Service","Fee","Status"],
        "Lean Consulting": ["Client","Date","Service","Fee","Status"]
      },
      "NonProfit": {
        "Charity": ["Beneficiary","Event Date","Service","Cost","Status"],
        "Outreach": ["Community","Date","Activity","Funding","Status"],
        "Youth Programs": ["Participant","Start Date","Program","Fee","Status"],
        "Support Services": ["Client","Date","Service","Fee","Status"],
        "Fundraising": ["Donor","Event Date","Amount","Status","Notes"]
      },
      "Landscaping": {
        "Maintenance": ["Client","Service Date","Yard Size","Charge","Status"],
        "Design": ["Client","Date","Design Type","Fee","Status"],
        "Tree Services": ["Client","Service Date","Tree Type","Charge","Status"],
        "Irrigation": ["Client","Install Date","System Type","Charge","Status"],
        "Garden": ["Client","Service Date","Service","Charge","Status"]
      },
      "Plumbing & HVAC": {
        "Plumbing": ["Client","Service Date","Issue","Charge","Status"],
        "HVAC Installation": ["Client","Install Date","System Type","Charge","Status"],
        "HVAC Repair": ["Client","Service Date","Issue","Charge","Status"],
        "Drain Cleaning": ["Client","Service Date","Service","Charge","Status"],
        "Furnace Servicing": ["Client","Service Date","Service","Charge","Status"]
      },
      "Electrical": {
        "Residential Electrician": ["Client","Service Date","Work Type","Charge","Status"],
        "Commercial Electrician": ["Client","Service Date","Work Type","Charge","Status"],
        "Repair": ["Client","Service Date","Issue","Charge","Status"],
        "Lighting": ["Client","Install Date","Light Type","Charge","Status"],
        "Inspection": ["Client","Inspection Date","Results","Fee","Status"]
      },
      "Carpentry": {
        "Furniture": ["Client","Date","Item","Charge","Status"],
        "Cabinet": ["Client","Install Date","Type","Charge","Status"],
        "Flooring": ["Client","Install Date","Material","Charge","Status"],
        "Deck": ["Client","Build Date","Material","Charge","Status"],
        "Trim": ["Client","Install Date","Type","Charge","Status"]
      },
      "Photography": {
        "Event": ["Client","Event Date","Type","Fee","Status"],
        "Portrait": ["Client","Session Date","Type","Fee","Status"],
        "Commercial": ["Client","Shoot Date","Type","Fee","Status"],
        "Drone": ["Client","Flight Date","Type","Fee","Status"],
        "Photojournalism": ["Client","Date","Event","Fee","Status"]
      },
      "Travel & Tourism": {
        "Travel Agent": ["Traveler","Booking Date","Package","Cost","Status"],
        "Tour Guide": ["Tourist","Tour Date","Location","Fee","Status"],
        "Adventure Travel": ["Traveler","Trip Date","Activity","Fee","Status"],
        "Cruise Booking": ["Client","Booking Date","Cruise","Cost","Status"],
        "Hotel Booking": ["Guest","Check-in Date","Room Type","Fee","Status"]
      },
      "Logistics": {
        "Warehouse": ["Client","Storage Start","Item","Qty","Fee"],
        "Freight Forwarder": ["Client","Ship Date","Goods","Fee","Status"],
        "Distribution": ["Client","Order Date","Items","Fee","Status"],
        "Inventory Mgmt": ["Client","Inventory Date","Items","Qty","Status"],
        "Cold Storage": ["Client","Start Date","Items","Qty","Fee"]
      },
      "Childcare": {
        "Daycare": ["Child Name","Start Date","Program","Fee","Parent Contact"],
        "After-school": ["Child Name","Session Date","Program","Fee","Status"],
        "Tutoring": ["Student","Session","Subject","Fee","Status"],
        "Summer Camp": ["Camper","Start Date","Activity","Fee","Status"],
        "Preschool": ["Child Name","Enrollment Date","Program","Fee","Status"]
      },
      "Pet Services": {
        "Grooming": ["Pet Name","Service Date","Service","Fee","Status"],
        "Pet Sitting": ["Pet Name","Service Date","Duration","Fee","Status"],
        "Vet": ["Pet Name","Visit Date","Service","Fee","Status"],
        "Daycare": ["Pet Name","Date","Service","Fee","Status"],
        "Training": ["Pet Name","Session Date","Type","Fee","Status"]
      },
      "Senior Care": {
        "Home Care": ["Client Name","Service Date","Care Type","Fee","Status"],
        "Assisted Living": ["Resident","Service Date","Service","Fee","Status"],
        "Nursing": ["Resident","Visit Date","Service","Fee","Status"],
        "Therapy": ["Client","Session Date","Service","Fee","Notes"],
        "Companionship": ["Client","Visit Date","Duration","Fee","Status"]
      },
      "Entertainment": {
        "Live Events": ["Event","Date","Venue","Fee","Ticket Sales"],
        "Music Shows": ["Artist","Date","Venue","Fee","Status"],
        "Comedy Shows": ["Comedian","Date","Venue","Fee","Status"],
        "Festivals": ["Event","Date","Location","Fee","Status"],
        "Private Parties": ["Client","Event Date","Service","Fee","Status"]
      }
    };

    let headers = [], dataRows = [];

    // Populate industry select
    const indSelect = document.getElementById("industrySelect");
    const subSelect = document.getElementById("subcategorySelect");
    Object.keys(industryMap).forEach(ind => indSelect.appendChild(Object.assign(document.createElement("option"), { value: ind, textContent: ind })));

    // On industry change: update subcategories
    indSelect.addEventListener("change", () => {
      subSelect.innerHTML = "";
      const subs = industryMap[indSelect.value];
      if (!subs) return;
      Object.keys(subs).forEach(sub => subSelect.appendChild(Object.assign(document.createElement("option"), { value: sub, textContent: sub })));
      generateMappingOptions();  // refresh mapping if file already loaded
    });

    // On file upload & read data
    document.getElementById("fileInput").addEventListener("change", e => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = evt => {
        const wb = XLSX.read(evt.target.result, { type: "binary" });
        const sheet = wb.Sheets[wb.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        headers = json[0] || [];
        dataRows = json.slice(1) || [];
        generateMappingOptions();
      };
      reader.readAsBinaryString(file);
    });

    // Generate mapping controls
    function generateMappingOptions() {
      const selIndustry = indSelect.value;
      const selSub = subSelect.value;
      const suggested = (industryMap[selIndustry] && industryMap[selIndustry][selSub]) || headers;
      const cont = document.getElementById("mappingContainer");
      cont.innerHTML = "";
      headers.forEach((h, idx) => {
        const wrapper = document.createElement("div");
        wrapper.className = "mapping-section";
        wrapper.innerHTML = `
          <input type="checkbox" checked />
          <select>${suggested.map(s => `<option value="${s}">${s}</option>`).join("")}</select>
          <input type="text" placeholder="Or enter custom label" data-index="${idx}" />
        `;
        cont.appendChild(wrapper);
      });
    }

    // Preview table
    function previewTable() {
      const rows = document.querySelectorAll("#mappingContainer .mapping-section");
      const mapped = [];
      const selectedCols = [];
      rows.forEach((row, idx) => {
        const cb = row.querySelector("input[type='checkbox']");
        if (cb.checked) {
          const sel = row.querySelector("select").value;
          const txt = row.querySelector("input[type='text']").value.trim();
          mapped.push(txt || sel);
          selectedCols.push(idx);
        }
      });

      const tbl = document.getElementById("previewTable");
      tbl.innerHTML = `
        <tr>${mapped.map(h => `<th>${h}</th>`).join("")}</tr>
        ${dataRows.map(r => `<tr>${selectedCols.map(i => `<td>${r[i] || ""}</td>`).join("")}</tr>`).join("")}
      `;
    }
  </script>
</body>
</html>
