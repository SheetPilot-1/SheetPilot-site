<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SheetPilot</title>
  <style>
    body {
      background-color: #1e3a5f;
      color: #f5f5dc; /* Cream color */
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #f5f5dc;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      color: #f5f5dc;
      display: block;
      margin: 10px 0 5px;
    }
    select, input[type="text"] {
      background-color: white;
      border: 2px solid #f5f5dc;
      color: #333;
      padding: 8px;
      width: 100%;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .form-section {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border-radius: 8px;
    }
    .form-section button {
      background-color: #00bfff;
      color: #1e3a5f;
      font-weight: bold;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      display: block;
      width: 100%;
    }
    .form-section button:hover {
      background-color: #00a5d1;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>
  <div class="form-section">
    <label for="industry">Select Your Industry:</label>
    <select id="industry" onchange="populateSubcategories()">
      <option value="">-- Select Industry --</option>
    </select>

    <label for="subcategory">Select Your Subcategory:</label>
    <select id="subcategory">
      <option value="">-- Select Subcategory --</option>
    </select>

    <label for="customIndustry">Or Manually Enter Industry:</label>
    <input type="text" id="customIndustry" placeholder="Custom Industry" />

    <label for="customSubcategory">Or Manually Enter Subcategory:</label>
    <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />
  </div>

  <script>
    const industryData = {
      "Finance": ["Accountants", "Financial Planners", "Loan Officers", "Insurance Agents", "Tax Preparers"],
      "Legal": ["Lawyers", "Paralegals", "Court Reporters", "Legal Assistants", "Notary Services"],
      "Healthcare": ["Doctors", "Nurses", "Therapists", "Chiropractors", "Dentists"],
      "Technology": ["Software Developers", "IT Support", "Cybersecurity", "Web Designers", "Data Analysts"],
      "Marketing": ["Marketing Agencies", "SEO Experts", "Graphic Designers", "Social Media Managers", "Copywriters"],
      "Real Estate": ["Agents", "Brokers", "Property Managers", "Inspectors", "Stagers"],
      "Education": ["Tutors", "Private Schools", "Test Prep", "Music Teachers", "Daycare Providers"],
      "Hospitality": ["Hotels", "Event Planners", "Caterers", "Restaurants", "Bars"],
      "Retail": ["Convenience Stores", "Clothing Boutiques", "Grocery Stores", "Gift Shops", "Jewelry Stores"],
      "Construction": ["General Contractors", "Electricians", "Plumbers", "Roofers", "Painters"],
      "Automotive": ["Mechanics", "Detailers", "Body Shops", "Dealerships", "Car Washes"],
      "Transportation": ["Trucking", "Moving Services", "Taxi Services", "Limo Services", "Logistics"],
      "Cleaning Services": ["Residential", "Commercial", "Carpet Cleaning", "Window Washing", "Junk Removal"],
      "Personal Care": ["Barbers", "Salons", "Spas", "Massage Therapists", "Personal Trainers"],
      "Pet Services": ["Pet Grooming", "Pet Sitting", "Dog Walking", "Pet Training", "Pet Stores"],
      "Landscaping": ["Mowing", "Tree Services", "Gardening", "Snow Removal", "Hardscaping"],
      "Faith-Based": ["Churches", "Ministries", "Faith-Based Nonprofits", "Counseling Services", "Religious Bookstores"],
      "Photography": ["Wedding Photographers", "Portrait Studios", "Drone Photography", "Product Photography", "Event Photographers"],
      "Fitness & Wellness": ["Gyms", "Yoga Studios", "Nutritionists", "Health Coaches", "Pilates Instructors"],
      "Home Services": ["HVAC", "Appliance Repair", "Handyman", "Pest Control", "Security Systems"],
      "Media & Entertainment": ["Videographers", "DJs", "Theater Companies", "Music Bands", "Event Hosts"],
      "Childcare": ["Nannies", "Babysitters", "Preschools", "After-School Programs", "Summer Camps"],
      "Artisans & Crafts": ["Woodworkers", "Pottery", "Jewelry Makers", "Leatherworkers", "Glass Blowers"],
      "Manufacturing": ["Metal Fabrication", "Wood Manufacturing", "Textile Production", "Food Processing", "Tool Makers"],
      "Nonprofits": ["Human Services", "Food Banks", "Shelters", "Environmental Orgs", "Community Outreach"],
      "Consulting": ["Business Coaches", "Life Coaches", "HR Consultants", "Sales Consultants", "Brand Consultants"],
      "Event Services": ["Wedding Planners", "Party Rentals", "Caterers", "Florists", "Balloon Artists"],
      "Logistics & Supply": ["Warehousing", "Shipping", "Courier Services", "Inventory Management", "Import/Export"],
      "Insurance": ["Life Insurance", "Auto Insurance", "Health Insurance", "Homeowners Insurance", "Business Insurance"],
      "Agriculture": ["Crop Farmers", "Livestock Farmers", "Beekeepers", "Farmers Markets", "Agritourism"]
    };

    const industrySelect = document.getElementById('industry');
    const subcategorySelect = document.getElementById('subcategory');

    Object.keys(industryData).forEach(industry => {
      const option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });

    function populateSubcategories() {
      const selectedIndustry = industrySelect.value;
      subcategorySelect.innerHTML = '<option value="">-- Select Subcategory --</option>';

      if (industryData[selectedIndustry]) {
        industryData[selectedIndustry].forEach(subcat => {
          const option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SheetPilot - Phase 2</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #1e4b6a; /* Phase 1 background color */
    color: #fff;
    margin: 0;
    padding: 20px;
  }
  h1 {
    color: #f5deb3; /* Bold cream color for title */
    text-align: center;
  }
  h2 {
    color: #f5deb3;
    margin-top: 40px;
  }
  label {
    display: block;
    margin-top: 20px;
    font-weight: bold;
    color: #f5deb3;
  }
  input[type="file"],
  select,
  input[type="text"] {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
    box-sizing: border-box;
    border: 2px solid #f5deb3;
    background-color: #1e4b6a;
    color: #fff;
  }
  select,
  input[type="text"] {
    background-color: #1e4b6a;
    border: 2px solid #f5deb3;
    color: #fff;
  }
  input[type="checkbox"] {
    margin-right: 5px;
  }
  .mapping-section {
    margin-top: 30px;
  }
  .mapping-section .mapping {
    margin-bottom: 15px;
  }
  .preview-btn {
    margin-top: 20px;
    background-color: #00bfff;
    color: #000;
    padding: 10px 15px;
    border: none;
    cursor: pointer;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background-color: #fff;
    color: #000;
  }
  th, td {
    border: 1px solid #000;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #00bfff;
  }
</style>
</head>
<body>

<h1>SheetPilot</h1>

<label for="file-upload">Upload Your File:</label>
<input type="file" id="file-upload" accept=".xlsx, .xls, .csv" />

<p>Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to hide columns you donâ€™t want in the final table.</p>

<div id="mapping-container" class="mapping-section"></div>

<button id="preview-btn" class="preview-btn">Preview Table</button>
<p>If you make changes, press this button again to see updates.</p>

<div id="table-container"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script>
  let workbook, headers = [], data = [];
  const fileInput = document.getElementById('file-upload');
  const mappingContainer = document.getElementById('mapping-container');
  const tableContainer = document.getElementById('table-container');
  const previewBtn = document.getElementById('preview-btn');

  const suggestedHeaders = {
    Finance: ["Client Name", "Service Date", "Amount", "Status", "Notes"],
    Healthcare: ["Patient Name", "Appointment Date", "Charge", "Status", "Notes"],
    Education: ["Student Name", "Enrollment Date", "Fees", "Status", "Notes"],
    // Add more industries and relevant suggested headers here
  };

  fileInput.addEventListener('change', handleFile, false);

  function handleFile(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const dataBinary = e.target.result;
      workbook = XLSX.read(dataBinary, { type: 'binary' });
      const sheetName = workbook.SheetNames[0];
      const sheet = workbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
      headers = jsonData[0];
      data = jsonData.slice(1);
      renderMappings();
    };
    reader.readAsBinaryString(file);
  }

  function renderMappings() {
    mappingContainer.innerHTML = '';
    headers.forEach(header => {
      const div = document.createElement('div');
      div.className = 'mapping';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = true;

      const label = document.createElement('label');
      label.textContent = header;

      const select = document.createElement('select');
      select.innerHTML = `<option value="">-- Select Header --</option>`;
      getSuggestedHeaders().forEach(suggested => {
        select.innerHTML += `<option value="${suggested}">${suggested}</option>`;
      });

      const customInput = document.createElement('input');
      customInput.type = 'text';
      customInput.placeholder = 'Or enter custom label';

      div.appendChild(checkbox);
      div.appendChild(label);
      div.appendChild(select);
      div.appendChild(customInput);
      mappingContainer.appendChild(div);
    });
  }

  function getSuggestedHeaders() {
    // For simplicity, returning a default set; can be dynamic based on phase1 selection
    return suggestedHeaders["Finance"] || headers;
  }

  previewBtn.addEventListener('click', () => {
    const mappedHeaders = [];
    const checkboxes = mappingContainer.querySelectorAll('input[type="checkbox"]');
    const selects = mappingContainer.querySelectorAll('select');
    const customInputs = mappingContainer.querySelectorAll('input[type="text"]');

    checkboxes.forEach((checkbox, index) => {
      if (checkbox.checked) {
        const selectVal = selects[index].value;
        const customVal = customInputs[index].value;
        const finalHeader = customVal || selectVal || headers[index];
        mappedHeaders.push(finalHeader);
      } else {
        mappedHeaders.push(null); // Hide this column
      }
    });

    const finalData = data.map(row => {
      const newRow = [];
      row.forEach((cell, index) => {
        if (mappedHeaders[index]) {
          newRow.push(cell);
        }
      });
      return newRow;
    });

    renderTable(mappedHeaders.filter(h => h), finalData);
  });

  function renderTable(headers, data) {
    let html = '<table><thead><tr>';
    headers.forEach(header => {
      html += `<th>${header}</th>`;
    });
    html += '</tr></thead><tbody>';
    data.forEach(row => {
      html += '<tr>';
      row.forEach(cell => {
        html += `<td>${cell !== undefined ? cell : ''}</td>`;
      });
      html += '</tr>';
    });
    html += '</tbody></table>';
    tableContainer.innerHTML = html;
  }
</script>

</body>
</html>
