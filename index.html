<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SheetPilot</title>
  <style>
    body {
      background-color: #1e3a5f;
      color: #f5f5dc; /* Cream color */
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #f5f5dc;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      color: #f5f5dc;
      display: block;
      margin: 10px 0 5px;
    }
    select, input[type="text"] {
      background-color: white;
      border: 2px solid #f5f5dc;
      color: #333;
      padding: 8px;
      width: 100%;
      border-radius: 4px;
      margin-bottom: 15px;
    }
    .form-section {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border-radius: 8px;
    }
    .form-section button {
      background-color: #00bfff;
      color: #1e3a5f;
      font-weight: bold;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      display: block;
      width: 100%;
    }
    .form-section button:hover {
      background-color: #00a5d1;
    }
  </style>
</head>
<body>
  <h1>SheetPilot</h1>
  <div class="form-section">
    <label for="industry">Select Your Industry:</label>
    <select id="industry" onchange="populateSubcategories()">
      <option value="">-- Select Industry --</option>
    </select>

    <label for="subcategory">Select Your Subcategory:</label>
    <select id="subcategory">
      <option value="">-- Select Subcategory --</option>
    </select>

    <label for="customIndustry">Or Manually Enter Industry:</label>
    <input type="text" id="customIndustry" placeholder="Custom Industry" />

    <label for="customSubcategory">Or Manually Enter Subcategory:</label>
    <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />
  </div>

  <script>
    const industryData = {
      "Finance": ["Accountants", "Financial Planners", "Loan Officers", "Insurance Agents", "Tax Preparers"],
      "Legal": ["Lawyers", "Paralegals", "Court Reporters", "Legal Assistants", "Notary Services"],
      "Healthcare": ["Doctors", "Nurses", "Therapists", "Chiropractors", "Dentists"],
      "Technology": ["Software Developers", "IT Support", "Cybersecurity", "Web Designers", "Data Analysts"],
      "Marketing": ["Marketing Agencies", "SEO Experts", "Graphic Designers", "Social Media Managers", "Copywriters"],
      "Real Estate": ["Agents", "Brokers", "Property Managers", "Inspectors", "Stagers"],
      "Education": ["Tutors", "Private Schools", "Test Prep", "Music Teachers", "Daycare Providers"],
      "Hospitality": ["Hotels", "Event Planners", "Caterers", "Restaurants", "Bars"],
      "Retail": ["Convenience Stores", "Clothing Boutiques", "Grocery Stores", "Gift Shops", "Jewelry Stores"],
      "Construction": ["General Contractors", "Electricians", "Plumbers", "Roofers", "Painters"],
      "Automotive": ["Mechanics", "Detailers", "Body Shops", "Dealerships", "Car Washes"],
      "Transportation": ["Trucking", "Moving Services", "Taxi Services", "Limo Services", "Logistics"],
      "Cleaning Services": ["Residential", "Commercial", "Carpet Cleaning", "Window Washing", "Junk Removal"],
      "Personal Care": ["Barbers", "Salons", "Spas", "Massage Therapists", "Personal Trainers"],
      "Pet Services": ["Pet Grooming", "Pet Sitting", "Dog Walking", "Pet Training", "Pet Stores"],
      "Landscaping": ["Mowing", "Tree Services", "Gardening", "Snow Removal", "Hardscaping"],
      "Faith-Based": ["Churches", "Ministries", "Faith-Based Nonprofits", "Counseling Services", "Religious Bookstores"],
      "Photography": ["Wedding Photographers", "Portrait Studios", "Drone Photography", "Product Photography", "Event Photographers"],
      "Fitness & Wellness": ["Gyms", "Yoga Studios", "Nutritionists", "Health Coaches", "Pilates Instructors"],
      "Home Services": ["HVAC", "Appliance Repair", "Handyman", "Pest Control", "Security Systems"],
      "Media & Entertainment": ["Videographers", "DJs", "Theater Companies", "Music Bands", "Event Hosts"],
      "Childcare": ["Nannies", "Babysitters", "Preschools", "After-School Programs", "Summer Camps"],
      "Artisans & Crafts": ["Woodworkers", "Pottery", "Jewelry Makers", "Leatherworkers", "Glass Blowers"],
      "Manufacturing": ["Metal Fabrication", "Wood Manufacturing", "Textile Production", "Food Processing", "Tool Makers"],
      "Nonprofits": ["Human Services", "Food Banks", "Shelters", "Environmental Orgs", "Community Outreach"],
      "Consulting": ["Business Coaches", "Life Coaches", "HR Consultants", "Sales Consultants", "Brand Consultants"],
      "Event Services": ["Wedding Planners", "Party Rentals", "Caterers", "Florists", "Balloon Artists"],
      "Logistics & Supply": ["Warehousing", "Shipping", "Courier Services", "Inventory Management", "Import/Export"],
      "Insurance": ["Life Insurance", "Auto Insurance", "Health Insurance", "Homeowners Insurance", "Business Insurance"],
      "Agriculture": ["Crop Farmers", "Livestock Farmers", "Beekeepers", "Farmers Markets", "Agritourism"]
    };

    const industrySelect = document.getElementById('industry');
    const subcategorySelect = document.getElementById('subcategory');

    Object.keys(industryData).forEach(industry => {
      const option = document.createElement('option');
      option.value = industry;
      option.textContent = industry;
      industrySelect.appendChild(option);
    });

    function populateSubcategories() {
      const selectedIndustry = industrySelect.value;
      subcategorySelect.innerHTML = '<option value="">-- Select Subcategory --</option>';

      if (industryData[selectedIndustry]) {
        industryData[selectedIndustry].forEach(subcat => {
          const option = document.createElement('option');
          option.value = subcat;
          option.textContent = subcat;
          subcategorySelect.appendChild(option);
        });
      }
    }
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SheetPilot</title>
<style>
  body {
    background-color: #19506B;
    color: #f5f5dc;
    font-family: Arial, sans-serif;
  }
  .container {
    width: 90%;
    max-width: 800px;
    margin: 20px auto;
  }
  label {
    display: block;
    margin: 10px 0;
  }
  input[type="checkbox"] {
    margin-right: 8px;
  }
  select, input[type="text"] {
    background-color: white;
    color: black;
    border: 2px solid #f5f5dc;
    border-radius: 4px;
    padding: 5px;
    width: calc(100% - 10px);
    margin-top: 4px;
  }
  .button {
    background: #00BFFF;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 10px 20px;
    margin-top: 15px;
    cursor: pointer;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background: white;
    color: black;
  }
  th, td {
    border: 1px solid #19506B;
    padding: 6px;
    text-align: left;
  }
</style>
</head>
<body>
<div class="container">
  <h1>SheetPilot</h1>

  <p>Upload Your File:</p>
  <input type="file" id="fileInput" />

  <h3>Map Your Columns</h3>
  <p>Use the dropdowns to map spreadsheet columns. Uncheck to exclude any columns from the final table. If you make changes, press the button again to see updates.</p>
  <div id="mappingContainer"></div>

  <button class="button" id="previewBtn">Preview Table</button>

  <div id="tableContainer"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
let headers = [];
let dataRows = [];

document.getElementById("fileInput").addEventListener("change", function(e) {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(evt) {
    const data = evt.target.result;
    const workbook = XLSX.read(data, { type: "binary" });
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });

    headers = json[0];
    dataRows = json.slice(1);

    const mappingContainer = document.getElementById("mappingContainer");
    mappingContainer.innerHTML = "";

    headers.forEach((header, i) => {
      const container = document.createElement("div");
      container.innerHTML = `
        <label>
          <input type="checkbox" checked>
          <select>
            ${headers.map(h => `<option value="${h}" ${h===header ? 'selected' : ''}>${h}</option>`).join("")}
          </select>
          <input type="text" placeholder="Or enter custom label" />
        </label>`;
      mappingContainer.appendChild(container);
    });
  };
  reader.readAsBinaryString(file);
});

document.getElementById("previewBtn").addEventListener("click", function() {
  const selectedHeaders = [];
  const selectedIndices = [];
  const mappingLabels = document.querySelectorAll("#mappingContainer label");

  mappingLabels.forEach(label => {
    const checkbox = label.querySelector("input[type='checkbox']");
    const dropdown = label.querySelector("select");
    const custom = label.querySelector("input[type='text']").value.trim();

    if (checkbox.checked) {
      const selected = dropdown.value;
      const finalHeader = custom || selected;
      selectedHeaders.push(finalHeader);
      selectedIndices.push(headers.indexOf(selected));
    }
  });

  let html = "<table><tr>" + selectedHeaders.map(h => `<th>${h}</th>`).join("") + "</tr>";
  dataRows.forEach(row => {
    html += "<tr>";
    selectedIndices.forEach(idx => {
      html += `<td>${row[idx] || ""}</td>`;
    });
    html += "</tr>";
  });
  html += "</table>";

  document.getElementById("tableContainer").innerHTML = html;
});
</script>
</body>
</html>
