<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SheetPilot </title>
<style>
  body {
    background-color: #33658A; /* lighter blue */
    color: #F5F5DC; /* deep cream */
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 20px;
  }
  h1 {
    font-size: 2rem;
    margin-bottom: 20px;
    color: #F5F5DC;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
    color: #F5F5DC;
  }
  select, input[type="text"], input[type="file"] {
    width: 100%;
    max-width: 380px;
    padding: 10px;
    margin-top: 6px;
    margin-bottom: 10px;
    border-radius: 6px;
    border: none;
    font-size: 1em;
    box-sizing: border-box;
    display: block;
  }
  button {
    background-color: #00E5FF;
    color: #000;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    margin-top: 10px;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #00cce0;
  }
  p.note {
    color: #ccc;
    font-size: 0.85rem;
    margin-top: 5px;
  }
</style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry</label>
  <select id="industry" onchange="updateSubcategories()">
    <option value="">-- Select Industry --</option>
    <option>Tutoring</option>
    <option>Real Estate</option>
    <option>Healthcare</option>
    <option>Finance</option>
    <option>Accounting</option>
    <option>Interior Design</option>
    <option>IT Services</option>
    <option>Construction</option>
    <option>Transportation</option>
    <option>Education</option>
    <option>Legal</option>
    <option>Consulting</option>
    <option>Auto Repair</option>
    <option>HVAC</option>
    <option>Plumbing</option>
    <option>Landscaping</option>
    <option>Marketing & Advertising</option>
    <option>Non-Profit</option>
    <option>Hospitality</option>
    <option>Cleaning Services</option>
    <option>Pet Grooming</option>
    <option>Veterinary</option>
    <option>Photography</option>
    <option>Event Planning</option>
    <option>Barbershop/Salon</option>
    <option>Nail Technician</option>
    <option>Tattoo & Piercing</option>
    <option>Roofing</option>
    <option>Electrical</option>
    <option>Welding & Fabrication</option>
    <option>Masonry</option>
    <option>Carpentry</option>
    <option>Moving & Storage</option>
    <option>Courier Services</option>
    <option>Security Services</option>
    <option>Publishing</option>
    <option>Fitness</option>
    <option>Food & Beverage</option>
    <option>Travel Services</option>
    <option>Childcare</option>
    <option>Retail</option>
    <option>Wholesale</option>
    <option>Logistics</option>
    <option>Insurance</option>
    <option>Entertainment</option>
    <option>Technology</option>
    <option>Home Improvement</option>
    <option>Manufacturing</option>
    <option>Waste Management</option>
  </select>

  <label for="subcategory">Select Your Subcategory</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />
  <button id="loadButton" onclick="loadFile()">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>

<script>
const subcategoryOptions = {
  "Tutoring": ["Kâ€“12", "College Prep", "Test Prep", "Private Instructor"],
  "Real Estate": ["Residential", "Commercial", "REIT"],
  "Healthcare": ["Home Care", "Nursing", "Dental", "Physical Therapy"],
  "Finance": ["Advisory", "CPA", "Wealth Management"],
  "Accounting": ["Tax Prep", "Bookkeeping", "Auditing"],
  "Interior Design": ["Residential", "Commercial", "Color Consulting"],
  "IT Services": ["Network Setup", "Remote Support", "Security"],
  "Construction": ["Residential", "Commercial", "Remodeling", "Roofing"],
  "Transportation": ["Fleet", "Logistics", "Courier", "Moving"],
  "Education": ["Tutoring", "Online Learning", "Curriculum Dev"],
  "Legal": ["Attorney", "Paralegal", "Notary"],
  "Consulting": ["Business Strategy", "Sales", "Operations"],
  "Auto Repair": ["Garage", "Mobile Mechanic"],
  "HVAC": ["Install", "Repair", "Maintenance"],
  "Plumbing": ["Residential", "Commercial", "Emergency"],
  "Landscaping": ["Design", "Maintenance", "Tree Service"],
  "Marketing & Advertising": ["SEO", "Social Media", "Branding"],
  "Non-Profit": ["Community Org", "Faith-Based", "Foundation"],
  "Hospitality": ["BnB", "Hotel", "Event Host"],
  "Cleaning Services": ["Residential", "Commercial", "Move-out"],
  "Pet Grooming": ["Salon", "Mobile", "Self-Serve"],
  "Veterinary": ["Clinic", "Mobile Vet"],
  "Photography": ["Wedding", "Portrait", "Product"],
  "Event Planning": ["Weddings", "Corporate", "Festivals"],
  "Barbershop/Salon": ["Barber", "Stylist", "Color"],
  "Nail Technician": ["Manicure", "Pedicure", "Nail Art"],
  "Tattoo & Piercing": ["Tattoo", "Piercing", "Aftercare"],
  "Roofing": ["Shingle", "Metal", "Repair", "Inspection"],
  "Electrical": ["Residential", "Commercial", "Panel Upgrades"],
  "Welding & Fabrication": ["Structural", "Custom", "Pipe"],
  "Masonry": ["Brick", "Stone", "Concrete", "Repair"],
  "Carpentry": ["Trim", "Decking", "Custom Furniture"],
  "Moving & Storage": ["Moving", "Storage", "Packing"],
  "Courier Services": ["Medical", "Same-Day", "Fleet"],
  "Security Services": ["Private", "Event", "Monitoring"],
  "Publishing": ["Books", "Blogs", "Magazines"],
  "Fitness": ["Gym", "Personal Trainer", "Yoga"],
  "Food & Beverage": ["Catering", "Food Truck", "Bakery"],
  "Travel Services": ["Agent", "Group Tours", "Booking"],
  "Childcare": ["Babysitting", "Daycare", "After School"],
  "Retail": ["Clothing", "Electronics", "Convenience Store"],
  "Wholesale": ["Suppliers", "B2B", "Bulk"],
  "Logistics": ["Shipping", "Supply Chain", "Distribution"],
  "Insurance": ["Broker", "Claims", "Adjuster"],
  "Entertainment": ["DJ", "Performer", "Event Host"],
  "Technology": ["App Dev", "Web Dev", "Support"],
  "Home Improvement": ["Painting", "Flooring", "Cabinetry"],
  "Manufacturing": ["Assembly", "Tooling", "Quality Control"],
  "Waste Management": ["Junk Removal", "Recycling", "Eco Disposal"]
};

function updateSubcategories() {
  const industry = document.getElementById("industry").value;
  const subcategory = document.getElementById("subcategory");
  subcategory.innerHTML = '<option value="">-- Choose Subcategory --</option>';

  if (subcategoryOptions[industry]) {
    subcategoryOptions[industry].forEach(option => {
      const el = document.createElement("option");
      el.value = option;
      el.textContent = option;
      subcategory.appendChild(el);
    });
  }
}

function loadFile() {
  const fileInput = document.getElementById('fileUpload');
  if (!fileInput.files.length) {
    alert("Please select a file first.");
    return;
  }
  alert("File ready to be processed (functionality to be implemented).");
}
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SheetPilot Phase 2</title>
<style>
  body {
    background-color: #33658A;
    color: #F5F5DC;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 20px;
  }
  h1 {
    font-size: 2rem;
    color: #F5F5DC;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: bold;
  }
  select, input[type="text"], input[type="file"] {
    width: 100%;
    max-width: 400px;
    padding: 10px;
    margin-top: 6px;
    border-radius: 6px;
    border: none;
    font-size: 1em;
    box-sizing: border-box;
    display: block;
  }
  button {
    background-color: #00E5FF;
    color: #000;
    border: none;
    padding: 12px 20px;
    border-radius: 8px;
    margin-top: 10px;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
  }
  button:hover { background-color: #00cce0; }
  table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
    background-color: #f5f5f5;
    color: #000;
  }
  th, td {
    padding: 8px;
    border-top: 1px solid #ccc;
  }
  th {
    background-color: #00E5FF;
  }
  tr:nth-child(even) { background-color: #e0e0e0; }
  .note {
    color: #ccc;
    font-size: 0.85rem;
  }
</style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="industry">Select Your Industry</label>
  <select id="industry">
    <option value="">-- Select Industry --</option>
    <option>IT Services</option>
    <option>Finance</option>
    <option>Construction</option>
    <option>Education</option>
    <option>Marketing</option>
    <!-- Add more as needed -->
  </select>

  <label for="subcategory">Select Your Subcategory</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
    <option>Remote Support</option>
    <option>CPA</option>
    <option>Remodeling</option>
    <option>Online Learning</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />
  <button id="loadButton">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>

  <div id="headerFields"></div>
  <div id="tablePreview"></div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script>
const popularHeaders = ["Name", "Email", "Phone", "Date", "Amount", "Service Type", "Status", "Notes", "Location"];

document.getElementById('loadButton').addEventListener('click', () => {
  const fileInput = document.getElementById('fileUpload');
  if (!fileInput.files.length) {
    alert("Please select a file first.");
    return;
  }
  handleFile({ target: { files: [fileInput.files[0]] } });
});

function handleFile(e) {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(evt) {
    const data = new Uint8Array(evt.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
    const json = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

    if (json.length === 0) {
      alert("Empty sheet.");
      return;
    }

    const headers = json[0];
    const rows = json.slice(1).filter(row => row.join("").trim() !== "");
    renderHeaderMapping(headers, rows);
  };
  reader.readAsArrayBuffer(file);
}

function renderHeaderMapping(headers, rows) {
  const container = document.createElement("div");
  container.style.marginTop = "20px";

  headers.forEach((header, i) => {
    const wrapper = document.createElement("div");
    wrapper.style.marginBottom = "10px";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.checked = true;
    checkbox.style.marginRight = "6px";

    const note = document.createElement("span");
    note.textContent = " Uncheck to hide this column";
    note.style.fontSize = "0.85rem";
    note.style.color = "#ccc";
    wrapper.appendChild(checkbox);
    wrapper.appendChild(note);

    const select = document.createElement("select");
    select.style.width = "100%";
    select.style.padding = "8px";
    select.style.marginTop = "5px";
    const defaultOption = document.createElement("option");
    defaultOption.textContent = "-- Choose or type your own --";
    defaultOption.value = "";
    select.appendChild(defaultOption);

    popularHeaders.forEach(opt => {
      const option = document.createElement("option");
      option.value = opt;
      option.textContent = opt;
      select.appendChild(option);
    });

    const input = document.createElement("input");
    input.type = "text";
    input.placeholder = "Or enter custom label";
    input.style.width = "100%";
    input.style.marginTop = "5px";

    wrapper.appendChild(select);
    wrapper.appendChild(input);
    container.appendChild(wrapper);
  });

  const previewButton = document.createElement("button");
  previewButton.textContent = "Preview Table";
  previewButton.style.marginTop = "15px";
  previewButton.onclick = () => previewTable(headers, rows, container);
  container.appendChild(previewButton);

  document.getElementById("headerFields").innerHTML = "";
  document.getElementById("headerFields").appendChild(container);
}

function previewTable(headers, rows, headerContainer) {
  const selects = headerContainer.querySelectorAll("select");
  const inputs = headerContainer.querySelectorAll("input[type='text']");
  const checkboxes = headerContainer.querySelectorAll("input[type='checkbox']");

  const finalHeaders = [];
  const visibleIndexes = [];
  checkboxes.forEach((cb, i) => {
    if (cb.checked) {
      const custom = inputs[i].value.trim();
      const selectVal = selects[i].value;
      finalHeaders.push(custom || selectVal || headers[i]);
      visibleIndexes.push(i);
    }
  });

  const table = document.createElement("table");
  const thead = document.createElement("thead");
  const trHead = document.createElement("tr");
  finalHeaders.forEach(h => {
    const th = document.createElement("th");
    th.textContent = h;
    trHead.appendChild(th);
  });
  thead.appendChild(trHead);
  table.appendChild(thead);

  const tbody = document.createElement("tbody");
  rows.forEach((row, rIndex) => {
    const tr = document.createElement("tr");
    visibleIndexes.forEach(i => {
      const td = document.createElement("td");
      td.textContent = row[i] || "";
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);

  document.getElementById("tablePreview").innerHTML = "";
  document.getElementById("tablePreview").appendChild(table);
}
</script>
</body>
</html>
