<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SheetPilot - Phase 1</title>
<style>
  body {
    background-color: #33658A;
    color: #F5F5DC;
    font-family: 'Segoe UI', sans-serif;
    padding: 20px;
  }
  h1 {
    font-size: 2rem;
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin-top: 12px;
    font-weight: bold;
  }
  input[type="file"] {
    width: 100%;
    max-width: 400px;
    margin-top: 6px;
  }
  button {
    background-color: #00E5FF;
    color: #000;
    border: none;
    padding: 12px 20px;
    border-radius: 6px;
    margin-top: 10px;
    font-weight: bold;
    cursor: pointer;
  }
  button:hover {
    background-color: #00cce0;
  }
  p.note {
    color: #ccc;
    font-size: 0.85rem;
    margin-top: 5px;
  }
</style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="fileUpload">Upload Your File:</label>
  <input type="file" id="fileUpload" accept=".xlsx, .csv" />
  <button id="loadButton" onclick="loadFile()">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
function loadFile() {
  const fileInput = document.getElementById('fileUpload');
  if (!fileInput.files.length) {
    alert("Please select a file first.");
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(evt) {
    const data = new Uint8Array(evt.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

    console.log("File parsed. Data ready for Phase 2:", jsonData);
    // Here youâ€™d normally store jsonData in a variable or pass it to Phase 2
    // For testing: just show a success message
    alert("File successfully uploaded and parsed!");
  };

  reader.readAsArrayBuffer(file);
}
</script>
</body>
</html>
