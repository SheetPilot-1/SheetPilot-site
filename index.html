<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SheetPilot</title>
<style>
  body { background-color: #33658A; color: #F5F5DC; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; }
  h1 { font-size: 2rem; margin-bottom: 15px; }
  label { display: block; margin-top: 12px; font-weight: bold; }
  select, input[type="text"], input[type="file"] { width: 100%; max-width: 400px; padding: 8px; margin-top: 6px; margin-bottom: 10px; border-radius: 6px; border: none; font-size: 1em; box-sizing: border-box; }
  button { background-color: #00E5FF; color: #000; border: none; padding: 10px 20px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; }
  button:hover { background-color: #00cce0; }
  .note { color: #ccc; font-size: 0.85rem; margin-top: 5px; }
  table { width: 100%; margin-top: 20px; border-collapse: collapse; background-color: #f0f0f0; color: #000; }
  th, td { padding: 8px; border: 1px solid #ccc; }
  th { background-color: #00E5FF; color: #000; }
  tr:nth-child(even) { background-color: #e0e0e0; }
  .section { margin-bottom: 20px; }
  .mapping-section { background: #1E3A5F; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
  .mapping-section label { color: #fff; margin-left: 5px; }
  .mapping-section div { color: #fff; margin-top: 5px; font-weight: bold; }
</style>
</head>
<body>

<h1>SheetPilot</h1>

<div class="section">
  <label for="industry">Select Your Industry:</label>
  <select id="industry" onchange="updateSubcategories()">
    <option value="">-- Select Industry --</option>
  </select>

  <label for="subcategory">Select Your Subcategory:</label>
  <select id="subcategory">
    <option value="">-- Choose Subcategory --</option>
  </select>

  <label for="customIndustry">Or Manually Enter Industry:</label>
  <input type="text" id="customIndustry" placeholder="Custom Industry" />

  <label for="customSubcategory">Or Manually Enter Subcategory:</label>
  <input type="text" id="customSubcategory" placeholder="Custom Subcategory" />

  <label for="fileInput">Upload Your File:</label>
  <input type="file" id="fileInput" />
  <button id="addReplaceButton">Add/Replace</button>
  <p class="note">Use this to upload additional data to the current table.</p>
</div>

<div id="phase2" class="section">
  <h2>Map Your Columns</h2>
  <p>Use this section to map your spreadsheet columns to custom or suggested headers. Uncheck to hide columns you donâ€™t want in the final table.</p>
  <div id="columnMappingContainer"></div>
  <button id="previewTableButton">Preview Table</button>
  <div id="previewContainer" style="margin-top: 20px;"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
// Full industry & subcategory list
const industryMap = {
  "Agriculture": ["Crop Production", "Animal Husbandry", "Aquaculture", "Agricultural Support Services"],
  "Apparel & Fashion": ["Clothing Manufacturing", "Footwear Production", "Textile Design", "Accessory Design"],
  "Automotive": ["Vehicle Manufacturing", "Auto Parts Suppliers", "Dealerships", "Auto Repair Services"],
  "Aviation & Aerospace": ["Aircraft Manufacturing", "Airlines", "Aerospace Engineering", "Air Traffic Control"],
  "Banking & Financial Services": ["Retail Banking", "Investment Banking", "Asset Management", "Credit Unions"],
  "Biotechnology": ["Pharmaceutical Research", "Genetic Engineering", "Bioinformatics", "Clinical Trials"],
  "Broadcast Media": ["Television Networks", "Radio Stations", "Podcasting", "Streaming Services"],
  "Building Materials": ["Cement Production", "Lumber Suppliers", "Glass Manufacturing", "Insulation Materials"],
  "Business Services": ["Consulting Firms", "Market Research", "Staffing Agencies", "Business Process Outsourcing"],
  "Chemicals": ["Industrial Chemicals", "Agricultural Chemicals", "Specialty Chemicals", "Petrochemicals"],
  "Civil Engineering": ["Infrastructure Development", "Structural Engineering", "Transportation Engineering", "Environmental Engineering"],
  "Commercial Real Estate": ["Property Management", "Commercial Leasing", "Real Estate Investment Trusts (REITs)", "Real Estate Development"],
  "Computer & Network Security": ["Cybersecurity Services", "Network Infrastructure", "Security Software Development", "Penetration Testing"],
  "Computer Games": ["Game Development", "Game Publishing", "eSports", "Mobile Gaming"],
  "Computer Hardware": ["PC Manufacturing", "Semiconductor Production", "Peripheral Devices", "Hardware Retail"],
  "Computer Networking": ["Network Design", "Internet Service Providers", "Cloud Networking", "Network Maintenance"],
  "Computer Software": ["Application Development", "Operating Systems", "Software as a Service (SaaS)", "Software Consulting"],
  "Construction": ["Residential Construction", "Commercial Construction", "Infrastructure Projects", "Renovation Services"],
  "Consumer Electronics": ["Smartphone Manufacturing", "Home Appliances", "Audio/Visual Equipment", "Wearable Technology"],
  "Consumer Goods": ["Packaged Foods", "Personal Care Products", "Household Products", "Beverages"],
  "Consumer Services": ["Retail Services", "Hospitality", "Personal Care Services", "Repair Services"],
  "Education": ["K-12 Schools", "Higher Education", "Online Learning Platforms", "Educational Publishing"],
  "Energy": ["Oil & Gas", "Renewable Energy", "Nuclear Power", "Energy Trading"],
  "Engineering Services": ["Mechanical Engineering", "Electrical Engineering", "Civil Engineering", "Environmental Engineering"],
  "Entertainment": ["Film Production", "Music Industry", "Live Events", "Streaming Services"],
  "Environmental Services": ["Waste Management", "Recycling Services", "Environmental Consulting", "Pollution Control"],
  "Fashion Design": ["Apparel Design", "Textile Design", "Fashion Merchandising", "Costume Design"],
  "Financial Services": ["Financial Planning", "Investment Services", "Insurance", "Mortgage Services"],
  "Food & Beverage": ["Restaurants", "Food Manufacturing", "Beverage Production", "Catering Services"],
  "Forestry": ["Timber Harvesting", "Forest Management", "Pulp and Paper Production", "Reforestation Services"],
  "Government": ["Federal Agencies", "State and Local Government", "Public Administration", "Regulatory Bodies"],
  "Healthcare": ["Hospitals", "Clinics", "Telemedicine", "Health Insurance"],
  "Hospitality": ["Hotels", "Resorts", "Bed & Breakfasts", "Hostels"],
  "Information Technology": ["IT Consulting", "Software Development", "Systems Integration", "IT Support Services"],
  "Insurance": ["Life Insurance", "Property & Casualty Insurance", "Health Insurance", "Reinsurance"],
  "Interior Design": ["Residential Design", "Commercial Design", "Space Planning", "Lighting Design"],
  "Internet Services": ["Web Hosting", "Internet Service Providers", "Online Portals", "E-commerce Platforms"],
  "Legal Services": ["Law Firms", "Corporate Legal Departments", "Legal Aid Services", "Notary Services"],
  "Logistics & Supply Chain": ["Freight Forwarding", "Warehousing", "Inventory Management", "Distribution Services"],
  "Manufacturing": ["Automotive Manufacturing", "Electronics Manufacturing", "Textile Manufacturing", "Machinery Production"],
  "Marine Transportation": ["Shipping Lines", "Port Operations", "Maritime Logistics", "Cruise Lines"],
  "Marketing & Advertising": ["Digital Marketing", "Advertising Agencies", "Public Relations", "Market Research"],
  "Media & Publishing": ["Newspapers", "Magazines", "Book Publishing", "Online Media"],
  "Mining & Metals": ["Mineral Extraction", "Metal Refining", "Quarrying", "Mining Equipment Manufacturing"],
  "Non-Profit Organizations": ["Charitable Organizations", "Foundations", "Advocacy Groups", "Community Services"],
  "Oil & Gas": ["Exploration & Production", "Refining", "Pipeline Transportation", "Oilfield Services"],
  "Pharmaceuticals": ["Drug Manufacturing", "Research & Development", "Clinical Trials", "Generic Pharmaceuticals"],
  "Photography": ["Portrait Photography", "Commercial Photography", "Photojournalism", "Event Photography"],
  "Printing & Publishing": ["Commercial Printing", "Book Publishing", "Magazine Publishing", "Digital Publishing"],
  "Professional Training & Coaching": ["Corporate Training", "Personal Coaching", "Educational Workshops", "Online Courses"],
  "Real Estate": ["Residential Sales", "Commercial Leasing", "Property Management", "Real Estate Investment"],
  "Renewable Energy": ["Solar Energy", "Wind Energy", "Hydro Power", "Bioenergy"],
  "Research & Development": ["Scientific Research", "Industrial Research", "Product Development", "Innovation Labs"],
  "Restaurants & Food Services": ["Fine Dining", "Fast Food", "Catering Services", "Food Trucks"],
  "Retail": ["Department Stores", "Specialty Stores", "Online Retail", "Convenience Stores"],
  "Security Services": ["Private Security", "Cybersecurity", "Surveillance Services", "Alarm Systems"],
  "Semiconductors": ["Chip Manufacturing", "Semiconductor Equipment", "Integrated Circuits", "Microprocessors"],
  "Software & Applications": ["Mobile App Development", "Enterprise Software", "Cloud Computing", "SaaS"],
  "Sports & Recreation": ["Professional Sports Teams", "Fitness Centers", "Recreational Facilities", "Sporting Goods Retail"],
  "Telecommunications": ["Mobile Network Operators", "Internet Service Providers", "Satellite Communications", "Telecom Equipment Manufacturing"],
  "Textiles": ["Fabric Manufacturing", "Textile Design", "Dyeing and Finishing", "Textile Machinery"],
  "Tourism & Travel": ["Travel Agencies", "Tour Operators", "Cruise Lines", "Adventure Travel"],
  "Transportation": ["Public Transit", "Freight Transportation", "Ride-Sharing Services", "Logistics Providers"],
  "Trucking": ["Long-Haul Trucking", "Local Delivery Services", "Freight Brokerage", "Truck Maintenance Services"],
  "Utilities": ["Electric Power Generation", "Water Supply", "Natural Gas Distribution", "Waste Management"],
  "Veterinary Services": ["Animal Hospitals", "Mobile Veterinary Clinics", "Pet Grooming", "Animal Shelters"],
  "Warehousing & Storage": ["Cold Storage", "Distribution Centers", "Fulfillment Services", "Self-Storage Facilities"],
  "Waste Management": ["Recycling Services", "Hazardous Waste Disposal", "Landfill Operations", "Composting Services"],
  "Wholesale Trade": ["Wholesale Distributors", "Import/Export Services", "Industrial Suppliers", "Wholesale Electronics"],
  "Wood Products": ["Lumber Mills", "Furniture Manufacturing", "Plywood Production", "Woodworking Shops"],
  "Writing & Editing": ["Content Creation", "Copywriting", "Technical Writing", "Editorial Services"],
  "Youth Services": ["Childcare Centers", "Youth Mentoring Programs", "After-School Programs", "Summer Camps"],
  "Zoological Services": ["Zoos & Aquariums", "Wildlife Conservation", "Animal Training", "Veterinary Research"],
  "3D Printing": ["Prototyping Services", "Custom Manufacturing", "3D Printing Equipment", "Materials Development"],
  "Artificial Intelligence": ["Machine Learning Development", "AI Research", "Natural Language Processing", "Robotics"]
};

function updateSubcategories() {
  const industry = document.getElementById("industry").value;
  const subcategory = document.getElementById("subcategory");
  subcategory.innerHTML = '<option value="">-- Choose Subcategory --</option>';
  if (industryMap[industry]) {
    industryMap[industry].forEach(option => {
      const el = document.createElement("option");
      el.value = option;
      el.textContent = option;
      subcategory.appendChild(el);
    });
  }
}

// Populate industries on load
window.onload = () => {
  const industrySelect = document.getElementById("industry");
  Object.keys(industryMap).forEach(industry => {
    const option = document.createElement("option");
    option.value = industry;
    option.textContent = industry;
    industrySelect.appendChild(option);
  });
};

let parsedData;

document.getElementById('addReplaceButton').addEventListener('click', () => {
  const fileInput = document.getElementById('fileInput');
  const file = fileInput.files[0];
  if (!file) {
    alert('Please select a file first.');
    return;
  }

  const reader = new FileReader();
  reader.onload = (e) => {
    const data = e.target.result;
    const workbook = XLSX.read(data, { type: 'binary' });
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];
    parsedData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
    buildColumnMapping(parsedData[0] || []);
  };
  reader.readAsBinaryString(file);
});

function buildColumnMapping(headers) {
  const container = document.getElementById('columnMappingContainer');
  container.innerHTML = '';
  headers.forEach((header, index) => {
    const section = document.createElement('div');
    section.className = 'mapping-section';

    const checkbox = document.createElement('input');
    checkbox.type = 'checkbox';
    checkbox.checked = true;

    const label = document.createElement('label');
    label.textContent = ' Include this column?';

    const columnLabel = document.createElement('div');
    columnLabel.textContent = header;

    const select = document.createElement('select');
    select.innerHTML = `<option value="${header}">${header}</option>`;
    select.style.width = '100%';
    select.style.marginTop = '5px';

    const input = document.createElement('input');
    input.type = 'text';
    input.placeholder = 'Or enter custom label';
    input.style.width = '100%';
    input.style.marginTop = '5px';

    section.appendChild(checkbox);
    section.appendChild(label);
    section.appendChild(columnLabel);
    section.appendChild(select);
    section.appendChild(input);
    container.appendChild(section);
  });
}

document.getElementById('previewTableButton').addEventListener('click', () => {
  const selectedIndices = [];
  const selectedHeaders = [];
  const mappingSections = document.getElementById('columnMappingContainer').children;
  Array.from(mappingSections).forEach((section, index) => {
    const includeCheckbox = section.querySelector('input[type="checkbox"]');
    if (includeCheckbox.checked) {
      selectedIndices.push(index);
      const input = section.querySelector('input[type="text"]');
      const customLabel = input.value.trim();
      const defaultHeader = section.querySelector('select').value;
      selectedHeaders.push(customLabel || defaultHeader);
    }
  });
  const table = document.createElement('table');
  const thead = document.createElement('thead');
  const headerRow = document.createElement('tr');
  selectedHeaders.forEach(header => {
    const th = document.createElement('th');
    th.textContent = header;
    headerRow.appendChild(th);
  });
  thead.appendChild(headerRow);
  table.appendChild(thead);
  const tbody = document.createElement('tbody');
  parsedData.slice(1).forEach(rowData => {
    const row = document.createElement('tr');
    selectedIndices.forEach(i => {
      const td = document.createElement('td');
      td.textContent = rowData[i] || '';
      row.appendChild(td);
    });
    tbody.appendChild(row);
  });
  table.appendChild(tbody);
  const previewContainer = document.getElementById('previewContainer');
  previewContainer.innerHTML = '';
  previewContainer.appendChild(table);
});
</script>
</body>
</html>
