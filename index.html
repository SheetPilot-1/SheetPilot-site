<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>SheetPilot - Phase 1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  body {
    background-color: #33658A;
    color: #F5F5DC;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    padding: 10px 20px;
  }
  h1 {
    font-size: 1.5rem;
    margin-bottom: 15px;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
    font-size: 0.9rem;
  }
  input[type="file"] {
    width: 100%;
    max-width: 100%;
    margin-top: 6px;
  }
  button {
    background-color: #00E5FF;
    color: #000;
    border: none;
    padding: 10px 18px;
    border-radius: 6px;
    margin-top: 10px;
    font-weight: bold;
    cursor: pointer;
    font-size: 0.95rem;
    width: 100%;
  }
  button:hover {
    background-color: #00cce0;
  }
  p.note {
    color: #ddd;
    font-size: 0.8rem;
    margin-top: 5px;
  }
  .file-upload {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  @media(min-width: 600px) {
    .file-upload {
      flex-direction: row;
      align-items: center;
      gap: 15px;
    }
    button {
      width: auto;
    }
  }
</style>
</head>
<body>
  <h1>SheetPilot</h1>

  <label for="fileUpload">Upload Your File:</label>
  <div class="file-upload">
    <input type="file" id="fileUpload" accept=".xlsx, .csv" />
    <button id="loadButton" onclick="loadFile()">Add/Replace</button>
  </div>
  <p class="note">Use this to upload additional data to the current table.</p>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script>
function loadFile() {
  const fileInput = document.getElementById('fileUpload');
  if (!fileInput.files.length) {
    alert("Please select a file first.");
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();

  reader.onload = function(evt) {
    const data = new Uint8Array(evt.target.result);
    const workbook = XLSX.read(data, { type: 'array' });
    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });

    console.log("File parsed. Data ready for Phase 2:", jsonData);
    alert("File successfully uploaded and parsed!");
  };

  reader.readAsArrayBuffer(file);
}
</script>
</body>
</html>
